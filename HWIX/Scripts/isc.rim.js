(function(i){var h=i.isc=i.isc||{},a=h.rim=h.rim||{};a.version="9.0.0000.0";a.point=function(a,b){this.getX=function(){return a};this.getY=function(){return b}};a.point.prototype.equals=function(a){return a.getX()==this.getX()&&a.getY()==this.getY()};a.point.prototype.createOffsetBy=function(b,c){return new a.point(this.getX()+b,this.getY()+c)};a.point.prototype.toString=function(){return ["POINT(",this.getX()," ",this.getY(),")"].join("")};a.point.prototype.clone=function(){return new a.point(this.getX(),this.getY())};a.point.prototype.getBounds=function(){var a=this.getX(),b=this.getY();return new h.rim.envelope(a,b,a,b)};a.point.distance=function(c,e,d,f){var a=c-d,b=e-f;return Math.sqrt(a*a+b*b)};a.point.midpoint=function(b,c,d,e){return new a.point(b+(d-b)/2,c+(e-c)/2)};a.envelope=function(b,c,d,e){this.getMinX=function(){return b};this.getMinY=function(){return c};this.getMaxX=function(){return d};this.getMaxY=function(){return e};this.clone=function(){return new a.envelope(b,c,d,e)};this.createFromMargins=function(f,g){return new a.envelope(b-f,c-g,d+f,e+g)};this.createFromBleed=function(h){var f=(d-b)*(h-1),g=(e-c)*(h-1);return new a.envelope(b-f,c-g,d+f,e+g)};this.getCenter=function(){return new a.point(b+(d-b)/2,c+(e-c)/2)};this.getWidth=function(){return d-b};this.getHeight=function(){return e-c};this.getArea=function(){return (d-b)*(e-c)}};a.envelope.prototype.getUL=function(){return new a.point(this.getMinX(),this.getMaxY())};a.envelope.prototype.getUR=function(){return new a.point(this.getMaxX(),this.getMaxY())};a.envelope.prototype.getLL=function(){return new a.point(this.getMinX(),this.getMinY())};a.envelope.prototype.getLR=function(){return new a.point(this.getMaxX(),this.getMinY())};a.envelope.prototype.equals=function(a){return a.getMinX()==this.getMinX()&&a.getMinY()==this.getMinY()&&a.getMaxX()==this.getMaxX()&&a.getMaxY()==this.getMaxY()};a.envelope.prototype.toString=function(){return [this.getMinX(),this.getMinY(),this.getMaxX(),this.getMaxY()].join(",")};a.envelope.prototype.toGeometry=function(){var a=new h.rim.geometry(true,true);a.addPointToLastSet(this.getUL());a.addPointToLastSet(this.getUR());a.addPointToLastSet(this.getLR());a.addPointToLastSet(this.getLL());a.addPointToLastSet(this.getUL());return a};a.envelope.createFromMdnXml=function(f){var a=$(f).find("Envelope"),d=parseFloat(a.attr("minX")),e=parseFloat(a.attr("minY")),b=parseFloat(a.attr("maxX")),c=parseFloat(a.attr("maxY"));return new h.rim.envelope(d,e,b,c)};a.envelope.createFromPoints=function(b,c){var d=b.getX(),f=b.getY(),e=c.getX(),g=c.getY();return new a.envelope(Math.min(d,e),Math.min(f,g),Math.max(d,e),Math.max(f,g))};a.envelope.createFromCenterAndMargins=function(b,c,d,e){return new a.envelope(b-d,c-e,b+d,c+e)};a.envelope.intersects=function(a,b){return !(a.getMinY()>b.getMaxY()||a.getMinX()>b.getMaxX()||a.getMaxY()<b.getMinY()||a.getMaxX()<b.getMinX())};a.envelope.prototype.contains=function(a){var b=a.getX(),c=a.getY();return b>=this.getMinX()&&b<=this.getMaxX()&&c>=this.getMinY()&&c<=this.getMaxY()};if(!Array.prototype.forEach)Array.prototype.forEach=function(b){var d=this.length;if(typeof b!="function")throw new TypeError;for(var c=arguments[1],a=0;a<d;a++)a in this&&b.call(c,this[a],a,this)};String.format=function(){for(var b=arguments[0],a=0;a<arguments.length-1;a++){var c=new RegExp("\\{"+a+"\\}","gm");b=b.replace(c,arguments[a+1])}return b};String.prototype.endsWith=function(a){return this.substr(this.length-a.length)===a};String.prototype.startsWith=function(a){return this.substr(0,a.length)===a};String.prototype.trim=function(){return this.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};String.prototype.leftTrim=function(){return this.replace(/^\s\s*/,"")};String.prototype.rightTrim=function(){return this.replace(/\s\s*$/,"")};a.animateScalar=function(h,i,b,f,c,d){var e={property:h},a=$(e),g={property:i};a.animate(g,{duration:b,step:f,complete:c,easing:d});return a};var d=$.browser,f,c=["translate(","","px,","","px)"],j=["translate3d(","","px,","","px, 0)"];if(d.msie)f=function(b,d,a){c[1]=b;c[3]=d;a.style.msTransform=c.join("")};else if(d.webkit)f=function(b,c,a){j[1]=b;j[3]=c;a.style.webkitTransform=j.join("")};else if(d.mozilla)f=function(b,d,a){c[1]=b;c[3]=d;a.style.MozTransform=c.join("")};else if(d.opera)f=function(b,d,a){c[1]=b;c[3]=d;a.style.OTransform=c.join("")};else f=function(b,d,a){c[1]=b;c[3]=d;a.style.transform=c.join("")};var e,b=["matrix(","",",0,0,","",",","",",","",")"],g=["matrix3d(","",",0,0,0,0,","",",0,0,0,0,1,0,","",",","",",0,1)"];if(d.msie)e=function(c,d,e,f,a){b[1]=c;b[3]=d;b[5]=e;b[7]=f;a.style.msTransform=b.join("")};else if(d.webkit)e=function(b,c,d,e,a){g[1]=b;g[3]=c;g[5]=d;g[7]=e;a.style.webkitTransform=g.join("")};else if(d.mozilla)e=function(c,d,e,f,a){b[1]=c;b[3]=d;b[5]=e+"px";b[7]=f+"px";a.style.MozTransform=b.join("")};else if(d.opera)e=function(c,d,e,f,a){b[1]=c;b[3]=d;b[5]=e;b[7]=f;a.style.OTransform=b.join("")};else e=function(c,d,e,f,a){b[1]=c;b[3]=d;b[5]=e;b[7]=f;a.style.transform=b.join("")};a.platform={browser:d,version:d.version,mobile:typeof orientation!="undefined"?true:false,touch:Modernizr.touch,gesture:"ongesturestart" in document.documentElement,canvas:Modernizr.canvas,cssAnimations:Modernizr.cssanimations,cssTransforms:Modernizr.csstransforms,cssTransforms3d:Modernizr.csstransforms3d,cssTransitions:Modernizr.csstransitions,geolocation:Modernizr.geolocation,inlineSvg:Modernizr.inlinesvg,svg:Modernizr.svg,ieTouch:i.navigator&&i.navigator.msPointerEnabled?true:false};a.platform.getDpi=function(){var b=document.getElementsByTagName("body")[0],a=document.createElement("div");a.style.width="1in";a.style.visibility="hidden";b.appendChild(a);var c=document.defaultView.getComputedStyle(a,null).getPropertyValue("width");b.removeChild(a);return parseInt(c,10)};a.offset=f;a.transform=e;$.extend(jQuery.easing,{easeMapCenterAnimate:function(e,d,a,b,c){return d==c?a+b:b*(-Math.pow(2,-10*d/c)+1)+a}});if(d.msie)$.extend(jQuery.easing,{easeZoomLevelAnimate:function(e,d,a,b,c){return d>=c*.5?a+b:b*(-Math.pow(2,-10*d/c)+1)+a}});else $.extend(jQuery.easing,{easeZoomLevelAnimate:function(e,d,a,b,c){return d==c?a+b:b*(-Math.pow(2,-10*d/c)+1)+a}})})(window);(function(m){var n=m.isc=m.isc||{},b=n.rim=n.rim||{},a=b.wkt=b.wkt||{},l=/^\s*point\s*\(/i,h=/^\s*linestring\s*\(/i,j=/^\s*polygon\s*\(\s*\(/i,i=/\s*multipoint\s*\(/i,f=/\s*multilinestring\s*\(\s*\(/i,g=/\s*multipolygon\s*\(\s*\(\s*\(/i,d=/\s*\)\s*$/,k=/\s*\)\)\s*$/,o=/\s*\)\)\)\s*$/,e=/\s*\)\s*,\s*\(\s*/g,p=/\s*\)\)\s*,\s*\(\(\s*/g;a.parsePoint=function(f){var c=f.replace(l,""),e=c.replace(d,""),a=e.split(" ",2);return new b.point(parseFloat(a[0]),parseFloat(a[1]))};a.parseMultiPoint=function(j){var a=new b.geometry(false,false),f=j.replace(i,""),g=f.replace(d,""),e=g.split(","),h=c(e);a.pushSet(h);return a};a.parseLineString=function(j){var a=new b.geometry(true,false),f=j.replace(h,""),g=f.replace(d,""),e=g.split(","),i=c(e);a.pushSet(i);return a};a.parseMultiLineString=function(n){for(var g=new b.geometry(true,false),i=n.replace(f,""),l=i.replace(k,""),d=l.replace(e,"$").split("$"),j=d.length,a=0;a<j;a++){var h=d[a].split(","),m=c(h);g.pushSet(m)}return g};a.parsePolygon=function(n){for(var f=new b.geometry(true,true),h=n.replace(j,""),l=h.replace(k,""),d=l.replace(e,"$").split("$"),i=d.length,a=0;a<i;a++){var g=d[a].split(","),m=c(g,true);f.pushSet(m)}return f};a.parseMultiPolygon=function(r){for(var i=new b.geometry(true,true),k=r.replace(g,""),n=k.replace(o,""),f=n.replace(p,"$").split("$"),l=f.length,a=0;a<l;a++)for(var h=f[a].replace(e,"$").split("$"),m=h.length,d=0;d<m;d++){var j=h[d].split(","),q=c(j,true);i.pushSet(q)}return i};var c=function(e,f){for(var a=[],g=e.length,c=0;c<g;c++){var d=e[c].trim().split(" ");a.push(parseFloat(d[0]));a.push(parseFloat(d[1]))}if(f==true){var b=a.length;if(b>=4)if(a[0]==a[b-2]&&a[1]==a[b-1]){a.pop();a.pop()}}return a};a.parse=function(b){if(b.search(l)>-1)return a.parsePoint(b);else if(b.search(h)>-1)return a.parseLineString(b);else if(b.search(j)>-1)return a.parsePolygon(b);else if(b.search(i)>-1)return a.parseMultiPoint(b);else if(b.search(f)>-1)return a.parseMultiLineString(b);else if(b.search(g)>-1)return a.parseMultiPolygon(b)}})(window);(function(j){var g=j.isc=j.isc||{},d=g.rim=g.rim||{},b=d.sphericalMercator=d.sphericalMercator||{},l=3857;b.getEpsg=function(){return l};var i=1,h=20;b.getMinZoomLevel=function(){return i};b.getMaxZoomLevel=function(){return h};var e=256;b.getTileSizePix=function(){return e};var k=96;b.getDpi=function(){return k};b.setDpi=function(a){k=a};var f=6378136.98;b.getRadius=function(){return f};var c=f*Math.PI*2,a=f*Math.PI;b.getCircumference=function(){return c};b.getHalfCircumference=function(){return a};b.getQuadTreeNodeToMapEnvelope=function(g,h,n){var b=Math.pow(2,n),e=g/b,k=-a+e*c;e=(g+1)/b;var i=-a+e*c,f=h/b,j=a-f*c;f=(h+1)/b;var l=a-f*c,m=new d.envelope(k,l,i,j);return m};b.getQuadTreeNodeRangeFromEnvelope=function(b,p){if(b instanceof g.rim.envelope){var e=Math.pow(2,p),i=b.getMinX(),j=b.getMinY(),f=b.getMaxX(),h=b.getMaxY();if(f>=a)f=a-1;if(i<=-a)i=-a+1;if(h>=a)h=a-1;if(j<=-a)j=-a+1;var n=Math.floor((i+a)/c*e),l=Math.floor((f+a)/c*e),o=Math.floor((a-h)/c*e),m=Math.floor((a-j)/c*e),k=new d.envelope(n,o,l,m);return k}return null};b.getProjectionUnitsPerPixel=function(b){var a=Math.pow(2,b);return c/a/e};b.getActualShapeScaleTransform=function(b){var a=Math.exp(b*2/f),c=Math.asin((a-1)/(a+1));return Math.cos(c)};b.getActualUnitsPerPixel=function(a,d){var b=this.getActualShapeScaleTransform(a.getY());return c/e*b/Math.pow(2,d)};b.getBestFitZoomLevelByExtents=function(b,a){var d=c/e/(b.getWidth()/a.getWidth()),f=c/e/(b.getHeight()/a.getHeight()),g=Math.min(d,f);return Math.max(i,Math.min(h,Math.log(g)/Math.log(2)))};b.getQuadKeyFromXYZ=function(f,g,e){for(var d=new Array(e),b=e;b>0;b--){var c=1<<b-1,a=0;if((f&c)!=0)a++;if((g&c)!=0)a+=2;d.push(a)}return d.join("")};b.getXYZFromQuadKey=function(h){for(var e=h.split(""),b=e.length,g=[{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1}],c=0,d=0,a=b;a>0;a--){var f=1<<a;c+=g[e[a-1]].x/f;d+=g[e[a-1]].y/f}c*=1<<b;d*=1<<b;return {x:c,y:d,z:b}};b.projectFromLatLon=function(c){if(c instanceof g.rim.point){var e=c.getY(),j=c.getX(),h,b;if(e>86)b=a;else if(e<-86)b=-a;else{var f=e/180*Math.PI,i=Math.log(Math.tan(f)+1/Math.cos(f));b=i/Math.PI*a}h=j/180*a;return new d.point(h,b)}return null};b.deprojectToLatLon=function(b){if(b instanceof g.rim.point){var c=Math.exp(b.getY()*2/f),h=Math.asin((c-1)/(c+1))/Math.PI*180,e=b.getX()/a*180;return new d.point(e,h)}return null}})(window);(function(e){var b=e.isc=e.isc||{},d=b.rim=b.rim||{},c=d.sphericalMercator=d.sphericalMercator||{},a=d.tile=d.tile||{};a.requestor=function(){this.get=function(c,a){var b=this.formatEndpoint(c,a);return b}};a.requestor.prototype.getIsRestImage=function(){return true};a.requestor.prototype.getDataFormat=function(){return "json"};a.quad=function(d,e,b){var f=null,g=[d,e,b].join(":");if(!(this instanceof a.quad))return new a.quad(d,e,b);this.getX=function(){return d};this.getY=function(){return e};this.getLevel=function(){return b};this.getEnvelope=function(){if(f==null)f=c.getQuadTreeNodeToMapEnvelope(d,e,b);return f};this.factoryParent=function(g){var f=Math.max(1,b-g),c=Math.pow(2,b-f),h=Math.floor(d/c),i=Math.floor(e/c);return new a.quad(h,i,f)};this.toString=function(){return g}};a.quad.prototype.getKey=function(){return c.getQuadKeyFromXYZ(this.getX(),this.getY(),this.getLevel())};a.quad.prototype.factoryQuadFromKey=function(d){var b=c.getXYZFromQuadKey(d);return new a.quad(b.x,b.y,b.z)};a.quad.prototype.equals=function(a){return a.getX()==this.getX()&&a.getY()==this.getY()&&a.getLevel()==this.getLevel()};a.quadView=function(k,s,w){if(!(this instanceof a.quadView))return new a.quadView(k,s,w);var z=k.getLevel(),m=k.getEnvelope(),j=w,f=b.rim.sphericalMercator.getTileSizePix(),u=m.getMinX(),y=m.getMinY(),x=m.getMaxX(),t=m.getMaxY();this.fastIntersects=function(c,d,a,b){return !(d>t||c>x||b<y||a<u)};this.getQuad=function(){return k};this.getLevel=function(){return z};this.getEnvelope=function(){return m};var d=document.createElement("canvas");d.className="canvasQuadView";d.id=k.toString();d.width=f+j;d.height=f+j;var c=d.getContext("2d");this.getCanvas=function(){return d};this.getContext=function(){return c};var p=this,h=false,i=false,o=false,n=function(){},q=function(){},v=function(){},r=15000,g=null,e=null,l=null;this.fireTimedOut=function(){q(p.getQuad()+": timed out");p.abort()};this.getIsLoading=function(){return h};this.getIsLoaded=function(){return i};this.getIsIdle=function(){return !h&&!i};this.getIsAborted=function(){return o};this.setLoadedAction=function(a){n=a};this.setTimedOutAction=function(a){q=a};this.setErrorAction=function(a){v=a};this.getData=function(){return e};this.beginGet=function(m,A,q){g!=null&&clearTimeout(g);if(typeof m.getTimeoutMs!="undefined")r=m.getTimeoutMs();var w=m.get(k,A);if(m.getIsRestImage()==true){var a=document.createElement("img"),z=$(a);i=false;h=true;o=false;z.load(function(){h=false;clearTimeout(g);z.unbind();if(c!=null){c.globalAlpha=s;if(q!=null){l=a;q.renderImage(l,c,f,j)}else{j>0&&c.drawImage(a,0,0,f+j,f+j);c.drawImage(a,0,0,f,f)}d.style.opacity=1;i=true;n(null);a=null}});a.src=w}else{i=false;h=true;o=false;e=[];$.ajax({url:w,timeout:r,dataType:m.getDataFormat(),success:function(g){i=true;n(null);if(c!=null&&q!=null&&g!=null){c.globalAlpha=s;var z=d.width/(x-u),A=d.height/(t-y),j=function(a){return (a-u)*z},k=function(a){return (t-a)*A};if(g.ShapeWkt)for(var B=g.ShapeWkt,C=g.Values,w=g.ShapeWkt.length,h=0;h<w;h++){var r=B[h];if(r){var l=C[h],a=b.rim.wkt.parse(r);if(a instanceof b.rim.geometry){var p=a.createFromTransformed(j,k);p.fieldValues=l;e.push(p)}else if(a instanceof b.rim.point){var v=new b.rim.point(j(a.getX()),k(a.getY()));v.fieldValues=l;e.push(v)}else if(a instanceof Array)for(var D=a.length,m=0;m<D;m++){var o=a[m].createFromTransformed(j,k);o.fieldValues=l;e.push(o)}}}q!=null&&e.length>0&&q.renderVector(e,c,f);d.style.opacity=1}},error:function(b,a){if(p.getIsAborted()==false){v("error: "+a);p.abort()}},complete:function(){h=false;clearTimeout(g)}})}g=setTimeout(this.fireTimedOut,r)};this.reRender=function(a){c.clearRect(0,0,d.width,d.height);if(a!=null)if(e!=null&&e.length>0)a.renderVector(e,c,f);else l!=null&&a.renderImage(l,c,f,j)};this.abort=function(){g!=null&&clearTimeout(g);o=true;g=null;n=function(){};q=function(){};h=false;i=false;d=null;c=null;e=null;l=null}};a.buildQuadTileListFromExtentsAtLevel=function(i,b){var d=[],a=c.getQuadTreeNodeRangeFromEnvelope(i,b),g=a.getMinX(),h=a.getMinY(),e=c.getQuadTreeNodeToMapEnvelope(g,h,b);f(a,b,d);return {quadCollection:d,idxMinX:g,idxMinY:h,ulX:e.getMinX(),ulY:e.getMaxY()}};var f=function(j,i,h){if(j instanceof b.rim.envelope)for(var f=j.getMinX(),g=j.getMinY(),k=j.getMaxX(),l=j.getMaxY(),d=Math.ceil((k-f)/2)+f,e=Math.ceil((l-g)/2)+g,r=Math.max(d-f,e-g)+1,c=0;c<r;c++)if(c==0){h.push(new a.quad(d,e,i));continue}else{var m=c-1;if(e-c>=g)for(var y=Math.max(f,d-c),z=Math.min(k,d+c),q=y;q<=z;q++)h.push(new a.quad(q,e-c,i));if(d+c<=k)for(var x=Math.max(g,e-m),w=Math.min(l,e+m),p=x;p<=w;p++)h.push(new a.quad(d+c,p,i));if(e+c<=l)for(var s=Math.max(f,d-c),t=Math.min(k,d+c),n=s;n<=t;n++)h.push(new a.quad(n,e+c,i));if(d-c>=f)for(var v=Math.max(g,e-m),u=Math.min(l,e+m),o=v;o<=u;o++)h.push(new a.quad(d-c,o,i))}}})(window);(function(b){var c=b.isc=b.isc||{},d=c.rim=c.rim||{},a=d.tile=d.tile||{};a.requestorBing=function(){if(!(this instanceof a.requestorBing))return new a.requestorBing;var k="dev.virtualearth.net/REST/v1/Imagery/Metadata/Road/0,0",h="http://ecn.{0}.tiles.virtualearth.net/tiles/{1}{2}.{3}?g={4}&mkt={5}&shading=hill",f="http",c="ecn.{0}.tiles.virtualearth.net/tiles/",n="{1}{2}.{3}",m="?g={4}&mkt={5}&shading=hill",d=915,i="en-US",g=["t0","t1","t2","t3"],b=0,e,l=function(){try{var a=f.substr(0,4)+"://"+k,b=String.format(a,e);$.ajax({url:b,dataType:"jsonp",data:{key:e,zoomLevel:1},jsonp:"jsonp",success:function(l){var e=l.resourceSets[0];if(e!=null&&e.resources!=null){var f=e.resources[0],a=f.imageUrl.toLowerCase(),b=a.indexOf("://");if(b!=-1){b+=3;var i=a.lastIndexOf("/");if(i!=-1){c=a.substr(b,i-b+1);c=c.replace(/.[a-z](\d+)/,".{0}")}}var k=/g=\d+/,h=k.exec(a);if(h!=null)d=parseInt(h[0].substr(2));if(f.imageUrlSubdomains!=null)g=f.imageUrlSubdomains}j()}})}catch(h){}},j=function(){h=f+"://"+c+n+m};this.getEndpoint=function(){return h};this.setScheme=function(a){f=a;j()};this.getScheme=function(){return f};this.setGeneration=function(a){d=a};this.getGeneration=function(){return d};this.setMarket=function(a){i=a};this.getMarket=function(){return i};this.setBingKey=function(a){e=a;l()};this.getBingKey=function(){return e};this.formatEndpoint=function(f,a){if(a==null)a="r";else a=a.toLowerCase();var c="jpg";if(a=="r")c="png";var e=String.format(h,g[b],a,f.getKey(),c,d,i);b++;if(b>=g.length)b=0;return e}};a.requestorBing.prototype=new a.requestor;a.requestorBing.constructor=a.requestorBing})(window);(function(a){var b=a.isc=a.isc||{},c=b.rim=b.rim||{},d=c.tile=c.tile||{};d.loader=function(m,l){var f=m,h=l||4,a=0,c=0,d=true,j,i,k,b,g=function(){},e=[];this.getLoadingProgress=function(){if(b==0)return 1;return c/b};this.setLoadingQueueHasEmptiedAction=function(a){g=a};this.clearLoadingQueue=function(){e=[];b=0;c=0;d=true};this.setLoadingQueue=function(a){e=a;b=a.length;c=0;d=false;j=f.getRequestor();i=f.getDescriptor();k=f.getRenderer();this.quadViewLoader()};this.quadViewLoader=function(){a<h&&c<b&&this.loadNextQuadView()};this.loadNextQuadView=function(){var b=e[c++];a=Math.min(a+1,h);b.beginGet(j,i,k)};this.decLoadingQueueRequestCount=function(){a=Math.max(a-1,0);this.quadViewLoader();if(d==false&&c==b&&a==0){g();d=true}}}})(window);(function(c){var a=c.isc=c.isc||{},d=a.rim=a.rim||{},b=d.tile=d.tile||{};b.renderer=function(){if(!(this instanceof b.renderer))return new b.renderer;var d=function(b,a){a.fillStyle="000000";a.beginPath();a.arc(b.getX(),b.getY(),5,0,Math.PI*2,true);a.fill();a.closePath()};this.setRenderPoint=function(a){d=a};var c=function(c,b){var d=new a.rim.styledGeometry(c);d.renderPathToCanvasContext(b)};this.setRenderGeometry=function(a){c=a};var e=function(d,b,e,c){var a=b.canvas.width;c>0&&b.drawImage(d,0,0,a+c,a+c);b.drawImage(d,0,0,a,a)};this.setRenderBitmap=function(a){this.renderImage=a};this.renderImage=e;this.renderVector=function(h,g,f){for(var i=h.length,e=0;e<i;e++){var b=h[e];if(b instanceof a.rim.geometry)c(b,g,f);else b instanceof a.rim.point&&d(b,g,f)}}};b.rendererDensityMap=function(){if(!(this instanceof b.rendererDensityMap))return new b.rendererDensityMap;var h=[[0,255,255,255],[24,32,32,96],[64,0,0,128],[96,0,0,255],[128,64,0,192],[153,128,0,128],[166,192,0,64],[179,255,0,0],[179,192,96,0],[191,224,224,0],[204,224,224,224]],o=1.33,c=48,i,g,d,e,f=-Number.MAX_VALUE,j,r=333,k=0,l=null,n;this.setBleed=function(a){o=a};this.setGridSize=function(a){c=a};this.setFilterStdDevRadius=function(a){g=a;d=Math.round(g*2+1);n=s()};this.setColorMatrix=function(a){h=a};this.setMinCellValue=function(a){k=a};this.setRowAction=function(a){l=a};this.setAssociatedTileLayer=function(a){i=a};this.notifyRecompute=function(){clearTimeout(j);f=-Number.MAX_VALUE;m()};this.renderVector=function(h,a,g){if(h!=null){e=-Number.MAX_VALUE;var b=g*(o-1),d=g+b*2;if(typeof a.grid=="undefined"||a.grid==null){var l=q(h,b,d);a.grid=l;a.gridMaxCellValue=e}else e=a.gridMaxCellValue;if(e>f){if(f!=-Number.MAX_VALUE){clearTimeout(j);j=setTimeout(m,r)}f=e}if(f>k){var i=p(a.grid);a.drawImage(i,0,0,c,c,-b,-b,d,d)}}};var m=function(){i!=null&&i.notifyRendererChange()},q=function(x,u,t){for(var A=x.length,g=[],s=[],b=0;b<c;b++){g[b]=[];s[b]=[]}for(b=0;b<A;b++){var q,f=x[b],r;if(l!=null)q=l(f);else q=1;if(f instanceof a.rim.geometry)r=f.getBounds().getCenter();else if(f instanceof a.rim.point)r=f;else continue;var D=r.getX(),E=r.getY(),m=Math.round((D+u)/t*c),o=Math.round((E+u)/t*c);if(m>=0&m<c&&o>=0&&o<c){var z=g[o][m];if(isNaN(z))g[o][m]=q;else g[o][m]=z+q}}for(var k=0;k<c;k++)for(var j=0;j<c;j++){for(var w=0,p=0,C=k+d,i=k-d;i<=C;i++){for(var v=0,B=j+d,h=j-d;h<=B;h++){if(h>=0&&h<c&&i>=0&&i<c){var y=g[i][h];if(!isNaN(y))p+=y*n[w][v]}v++}w++}s[k][j]=p;if(p>e)e=p}return s},p=function(o){var d=document.createElement("canvas");d.width=c;d.height=c;for(var i=d.getContext("2d"),l=i.createImageData(c,c),e=l.data,h=0;h<c;h++)for(var n=o[h],m=h*c*4,g=0;g<c;g++){var j=n[g];if(isNaN(j))continue;var b=t(j,k,f),a=m+g*4;e[a]=b.r;e[a+1]=b.g;e[a+2]=b.b;e[a+3]=b.a}i.putImageData(l,0,0);return d},t=function(b,e,l){var n=l-e;b=b>l?l:b;b=b<e?e:b;var f=(b-e)/n;f*=h.length-1;var k=Math.round(f),c=f-k,g,m,i,j,a=h[k];if(c<.001){g=a[0];m=a[1];i=a[2];j=a[3]}else{var d=h[k+1];g=(d[0]-a[0])*c+a[0];m=(d[1]-a[1])*c+a[1];i=(d[2]-a[2])*c+a[2];j=(d[3]-a[3])*c+a[3]}return {r:m,g:i,b:j,a:g}},s=function(){for(var c=[],e=d,f=d*2+1,p=1/(2*g*g),a=0;a<f;a++){c[a]=[];if(a<=e){for(var b=0;b<=e;b++){var q=(Math.pow(e-a,2)+Math.pow(e-b,2))*p,i=Math.exp(-q),k=e-b,l=e-a,o=Math.sqrt(k*k+l*l),j=o-d;if(j>1)i=0;else if(j>0)i*=1-j;c[a][b]=i}for(;b<f;b++){var m=c[a][f-(b+1)];c[a][b]=m}}else for(var h=0;h<f;h++){var n=c[f-(a+1)][h];c[a][h]=n}}return c};this.setFilterStdDevRadius(2)}})(window);(function(e){var b=e.isc=e.isc||{},c=b.rim=b.rim||{},d=c.sphericalMercator=c.sphericalMercator||{},a=c.tile=c.tile||{};a.layer=function(Q,r,H){if(!(this instanceof a.layer))return new a.layer(Q,r,H);var Y=Q,W=r||false,U=H||2,f=null,k=null,e=null,g=null,j,V,x,s,w,o,v=true,t=1,q=d.getMinZoomLevel(),u=d.getMaxZoomLevel(),i=function(){},C=function(){},K=function(){},N=null,T=1e3,z=null,m=0,I=0,y=null,A=false,L=3,P=b.rim.sphericalMercator.getTileSizePix(),O=1,X=this,S=c.platform.mobile?2:8,E=0,F=0;this.setContentExtentsMarginInPixels=function(a){E=a;F=a*S};var n=new a.loader(this,U),h={},p=null,G=function(){if(e!=null)while(e.firstChild)e.removeChild(e.firstChild)},D=function(){if(p==null)p=setTimeout(G,500)},R=function(){if(p!=null){clearTimeout(p);p=null}};this.getId=function(){return Y};this.getUseBackdrop=function(){return W};this.setDescriptor=function(a){if(s!=a){s=a;i(this,"descriptor");s.setNotifyDescriptorChangeAction&&s.setNotifyDescriptorChangeAction(function(){i(X,"descriptor")})}};this.getDescriptor=function(){return s};this.notifyDescriptorChange=function(){i(this,"descriptor")};this.setRequestor=function(a){if(w!=a){w=a;i(this,"requestor")}};this.getRequestor=function(){return w};this.setRenderer=function(a){if(o!=a){o=a;typeof o.setAssociatedTileLayer!="undefined"&&o.setAssociatedTileLayer(this);i(this,"renderer")}};this.getRenderer=function(){return o};this.notifyRendererChange=function(){i(this,"renderer")};this.setIsVisible=function(a){if(v!=a){v=a;i(this,"visibility")}};this.getIsVisible=function(){return v};this.setOpacity=function(b){var a=Math.min(Math.max(b,0),1);if(a!=t){t=a;i(this,"opacity")}};this.getOpacity=function(){return t};this.setMinZoomLevel=function(a){if(q!=a){q=a;i(this,"zoom level constraint")}};this.getMinZoomLevel=function(){return q};this.setMaxZoomLevel=function(a){if(u!=a){u=a;i(this,"zoom level constraint")}};this.getMaxZoomLevel=function(){return u};this.setTileBleedPix=function(a){O=a};this.setParentContainer=function(a){j=a;V=$(a)};this.setZindex=function(a){x=a};this.setNotifyTileContentChangeAction=function(a){i=a};this.setNotifyLoadingQueueHasEmptiedAction=function(a){C=a};n.setLoadingQueueHasEmptiedAction(function(){D();C()});this.setNotifyErrorAction=function(a){K=a};this.isLayerRenderable=function(a){if(w!=null&&v==true&&t>0&&q<=a&&u>=a)return true;return false};this.isContentDisplayed=function(){return f.childNodes.length>0};this.updateQuadViewsToExtents=function(h,i,u,b,j,c,x){var w=b-m;z=u;m=b;I=c;var s=[],d=[],J=n.getLoadingProgress();n.clearLoadingQueue();var C=E*c;y=u.createFromMargins(C,C);if(r==true){var o=[],K=b%L+L,v=Math.max(q,b-K),p=a.buildQuadTileListFromExtentsAtLevel(y,v),F=p.quadCollection;B(F,d,o);M(g,o,h,i,j,c,p,v,x)}var t=a.buildQuadTileListFromExtentsAtLevel(y,b),H=t.quadCollection;B(H,d,s);if(r==true&&k!=null&&(w==-1||w>0)&&J>.33){R();G();f.removeChild(k);e.ulX=f.ulX;e.ulY=f.ulY;e.idxMinX=f.idxMinX;e.idxMinX=f.idxMinY;e.pLevel=f.pLevel;l(h,i,j,c,e);e.appendChild(k)}k=M(f,s,h,i,j,c,t,b,x);if(d.length>0){n.setLoadingQueue(d);A=true}else D()};var M=function(a,e,g,h,i,f,b,d,j){var c=a.firstChild,k=a.pLevel||0;if(j==true||d!=k||c==null){a.ulX=b.ulX;a.ulY=b.ulY;a.idxMinX=b.idxMinX;a.idxMinY=b.idxMinY;a.pLevel=d;c=document.createElement("div");J(b.idxMinX,b.idxMinY,e,c);while(a.firstChild)a.removeChild(a.firstChild);l(g,h,i,f,a);a.appendChild(c)}else{a.ulX=a.ulX||b.ulX;a.ulY=a.ulY||b.ulY;a.idxMinX=a.idxMinX||b.idxMinX;a.idxMinY=a.idxMinY||b.idxMinY;a.pLevel=d;J(a.idxMinX,a.idxMinY,e,c);l(g,h,i,f,a)}return c},J=function(n,o,g,i){for(var d=i.childNodes,c=d?d.length:0,h=[],a=0;a<c;a++)h.push(d[a].id);var m=g.length;for(a=0;a<m;a++){var k=g[a],f=k.getQuad(),r=f.toString();if(c>0){for(var l=false,e=0;e<c;e++){var q=h[e];if(q==r){l=true;break}}if(l==true)continue}var p=(f.getX()-n)*P,s=(f.getY()-o)*P,j=k.getCanvas();b.rim.offset(p,s,j);i.appendChild(j)}};this.updateExtentTransform=function(b,c,d,a){f!=null&&l(b,c,d,a,f);e!=null&&l(b,c,d,a,e);g!=null&&l(b,c,d,a,g)};var l=function(i,j,e,d,a){var c=a.pLevel;if(c){var g=(a.ulX-i)/d,h=(j-a.ulY)/d;if(e==c)b.rim.offset(g,h,a);else{var f=Math.pow(2,e-c);b.rim.transform(f,f,g,h,a)}}},B=function(j,g,i){for(var l=j.length,e=0;e<l;e++){var k=j[e],f=k.toString();if(!(f in h)){var b=new a.quadView(k,t,O),d=function(a){n.decLoadingQueueRequestCount();a!=null&&K(a)};b.setLoadedAction(d);b.setTimedOutAction(d);b.setErrorAction(d);h[f]=b;g.push(b);i.push(b)}else{var c=h[f];if(c.getIsAborted()==false){i.push(c);c.getIsIdle()&&g.push(c)}}}};this.addDisplayContainers=function(){if(r==true){g=this.factoryContainer(x-2);j.appendChild(g);e=this.factoryContainer(x-1);j.appendChild(e)}f=this.factoryContainer(x);j.appendChild(f)};this.removeDisplayContainers=function(){if(f!=null){j.removeChild(f);f=null}if(e!=null){j.removeChild(e);e=null}if(g!=null){j.removeChild(g);g=null}};this.factoryContainer=function(c){var b=document.createElement("div"),a=$(b);a.addClass("tileContainer");a.css("z-index",c);return b};this.flushContent=function(){h={}};this.flushDisplayContainers=function(){if(f!=null)while(f.firstChild)f.removeChild(f.firstChild);if(g!=null)while(g.firstChild)g.removeChild(g.firstChild);if(e!=null)while(e.firstChild)e.removeChild(e.firstChild)};this.reRenderContent=function(){for(var b in h){var a=h[b],c=a.getLevel();if(c!=m){a.abort();delete h[b]}a.getIsAborted()==false&&a.reRender(o)}};this.cleanUpQuadViewDictionaryAndContainer=function(){if(A==true&&m>0&&z!=null){A=false;var l=F*I,b=z.createFromMargins(l,l),t=b.getMinX(),u=b.getMinY(),r=b.getMaxX(),s=b.getMaxY(),q=m-1,o=g!=null&&g.pLevel?g.pLevel:0,p=m+1;for(var f in h){var a=h[f];if(a.getIsAborted()==true){delete h[f];continue}var d=a.getLevel();if(d>p||d<q&&d!=o||!a.fastIntersects(t,u,r,s)){a.getIsLoading()==true&&n.decLoadingQueueRequestCount();a.abort();delete h[f]}}if(k!=null)for(var c=k.childNodes,i=c?c.length:0,e=0;e<i;e++){var j=c[e];if(!(j.id in h)){k.removeChild(j);i--}}}};this.startCleanup=function(){N=setInterval(this.cleanUpQuadViewDictionaryAndContainer,T)};this.stopCleanup=function(){clearInterval(N)}}})(window);(function(d){var b=d.isc=d.isc||{},a=b.rim=b.rim||{},c=a.content=a.content||{};c.layer=function(s,q,o){if(!(this instanceof c.layer))return new c.layer(s,q,o);var e=[],h={},k=0,f,i,j,m,n=o,d=document.createElement("div"),l=$(d),t=this;l.addClass("contentContainer");l.css("z-index",q);l.attr("id","isc_rim_content_div");s.append(d);var g=false;this.haveContent=function(){return g};this.setContentExtentsMarginInPixels=function(a){n=a};this.addFixedElement=function(a,b,c,d){g=true;var f=e.indexOf(a);if(f>=0){t.moveFixedElement(a,b,c);return}a.insertionPtInMapUnitsX=b;a.insertionPtInMapUnitsY=c;if(d!=undefined)a.addAction=d;e.push(a);r(a,b,c)};var r=function(a,g,h){var c=(g-i)/f,e=(j-h)/f;b.rim.offset(c,e,a);d.appendChild(a);a.addAction!=undefined&&a.addAction(a)};this.moveFixedElement=function(a,c,d){if(e.indexOf(a)>=0){a.insertionPtInMapUnitsX=c;a.insertionPtInMapUnitsY=d;var g=(c-i)/f,h=(j-d)/f;b.rim.offset(g,h,a)}};this.removeFixedElement=function(a){var b=e.indexOf(a);if(b>=0){d.removeChild(a);e.splice(b,1);g=e.length>0||k>0}};this.addPathGeometry=function(a,c){if(a.getIsPath()==true){this.removePathGeometry(c);g=true;var b=a.createSvgPathElement(c,f);h[c]={geometry:a,domElement:b};k++;p(b);return b}return null};var p=function(a){var c=a.bounds,e=(c.getMinX()-i)/f,g=(j-c.getMaxY())/f;b.rim.offset(e,g,a);d.appendChild(a)};this.removePathGeometry=function(a){if(a in h){var b=l.children("#"+a);b.remove();delete h[a];k--;g=e.length>0||k>0}};this.updateContainerToExtents=function(s,t,B,u,c,D,E){if(E==true){i=s;j=t;m=B;f=c;if(g==true){d.style.visibility="hidden";while(d.firstChild)d.removeChild(d.firstChild);for(var A=e.length,o=0;o<A;o++){var l=e[o];r(l,l.insertionPtInMapUnitsX,l.insertionPtInMapUnitsY)}var z=n*c,C=D.createFromMargins(z,z);for(var x in h){var q=h[x],F=q.geometry,k=q.domElement;if(a.envelope.intersects(k.bounds,C)==true){if(k.mupp!=c){k=F.createSvgPathElement(x,c);q.domElement=k}p(k)}}d.style.visibility="visible"}}var w=(i-s)/c,y=(t-j)/c;if(u==m)b.rim.offset(w,y,d);else{var v=Math.pow(2,u-m);b.rim.transform(v,v,w,y,d)}}};a.geometryStyle=function(){var a=1,c="#000000",b=1,f="#FFFFFF",d=.5,e=null;this.getOutlineThicknessPix=function(){return a};this.setOutlineThicknessPix=function(b){a=b};this.getOutlineColor=function(){return c};this.setOutlineColor=function(a){c=a};this.getOutlineOpacity=function(){return b};this.setOutlineOpacity=function(a){b=a};this.getFillColor=function(){return f};this.setFillColor=function(a){f=a};this.getFillOpacity=function(){return d};this.setFillOpacity=function(a){d=a};this.getDashArray=function(){return e};this.setDashArray=function(a){e=a}};a.styledGeometry=function(b,c){if(!(this instanceof a.styledGeometry))return new a.styledGeometry(b,c);var e=1,g="#000000",f=1,j="#FFFFFF",h=.5,i=null,d=null;if(c!=null){e=c.getOutlineThicknessPix();g=c.getOutlineColor();f=c.getOutlineOpacity();j=c.getFillColor();h=c.getFillOpacity();i=c.getDashArray()}this.getGeometry=function(){return b};this.getOutlineThicknessPix=function(){return e};this.setOutlineThicknessPix=function(a){e=a};this.getOutlineColor=function(){return g};this.setOutlineColor=function(a){g=a};this.getOutlineOpacity=function(){return f};this.setOutlineOpacity=function(a){f=a};this.getFillColor=function(){return j};this.setFillColor=function(a){j=a};this.getFillOpacity=function(){return h};this.setFillOpacity=function(a){h=a};this.getDashArray=function(){return i};this.setDashArray=function(a){i=a};this.getAnimation=function(){return d};this.setAnimation=function(a){d=a};this.createSvgPathElement=function(r,e){var i="http://www.w3.org/2000/svg",c=document.createElementNS(i,"svg"),h=this.getOutlineThicknessPix(),k=h*e,f=b.getBounds().createFromMargins(k,k);c.bounds=f;c.mupp=e;c.setAttribute("id",r);c.setAttribute("height",f.getHeight()/e);c.setAttribute("width",f.getWidth()/e);c.setAttribute("style","position: absolute; left: 0; top: 0;");var n=f.getMinX(),m=f.getMaxY(),p=function(a){return (a-n)/e},q=function(a){return (m-a)/e},o=b.createFromTransformed(p,q),j=o.toSvgPathData();if(j!=null){var g=document.createElementNS(i,"path");g.setAttribute("d",j);var a=$(g);a.css("stroke",this.getOutlineColor());a.css("stroke-opacity",this.getOutlineOpacity());a.css("stroke-width",h);a.css("fill-rule","evenodd");if(b.getIsClosed()==true){a.css("fill",this.getFillColor());a.css("fill-opacity",this.getFillOpacity())}else{a.css("fill","transparent");a.css("fill-opacity",0)}var l=this.getDashArray();l!=null&&a.css("stroke-dasharray",l);d!=null&&d(g,d);c.appendChild(g)}return c};this.renderPathToCanvasContext=function(a){if(this.getIsPath()==true){var g=b.getSetCount();a.save();a.fillStyle=this.getFillColor();a.strokeStyle=this.getOutlineColor();a.lineJoin="round";a.lineWidth=this.getOutlineThicknessPix();a.beginPath();for(var e=0;e<g;e++)for(var d=b.getSet(e),f=d.length,c=0;c<f;c+=2)if(c==0)a.moveTo(d[c],d[c+1]);else a.lineTo(d[c],d[c+1]);this.getIsClosed()==true&&a.closePath();a.globalAlpha=this.getOutlineOpacity();a.stroke();if(this.getIsClosed()==true){a.globalAlpha=this.getFillOpacity();a.fill()}a.restore()}return null};this.createFromTransformed=function(c,d){var e=b.createFromTransformed(c,d);return new a.styledGeometry(e)};this.foreachVertex=b.foreachVertex;this.getBounds=b.getBounds;this.getIsPath=b.getIsPath;this.getIsClosed=b.getIsClosed;this.getSetCount=b.getSetCount;this.getSet=b.getSet;this.pushSet=b.pushSet;this.popSet=b.popSet;this.toSvgPathData=b.toSvgPathData;this.addPointToLastSet=b.addPointToLastSet;this.isValid=b.isValid;this.toString=b.toString}})(window);(function(d){var c=d.isc=d.isc||{},a=c.rim=c.rim||{},b=a.sphericalMercator=a.sphericalMercator||{};a.viewmodel=function(t,B,G){if(!(this instanceof a.viewmodel))return new a.viewmodel(t,B,G);var s=this,d=B||1,h=Math.round(d),o=B||1,i=false,n=t||new a.point(0,0),e=t.getX()||0,f=t.getY()||0,r=t||new a.point(0,0),m=false,g=b.getProjectionUnitsPerPixel(d),j=G||[],q=b.getMinZoomLevel(),p=b.getMaxZoomLevel(),A=null,k=true,w={haveContent:function(){return false}},F=null,u=null,x=0,v=0,y=function(){},z=function(){},l=function(){};this.setNotifyTileContentConfigurationChangeAction=function(a){y=a};this.setNotifyTileContentChangeAction=function(a){z=a;j.forEach(function(a){a.setNotifyTileContentChangeAction(z)})};this.setNotifyExtentChangeAction=function(a){l=a};this.forceNotifyExtentChangeAction=function(){l(e,f,h,d,g,i)};this.setContentExtentsMarginInPixelsOnAllLayers=function(a){w.setContentExtentsMarginInPixels&&w.setContentExtentsMarginInPixels(a);j.forEach(function(b){b.setContentExtentsMarginInPixels(a)})};this.updateQuadViewsOnRenderableTileLayersToCurrentExtents=function(c){for(var i=s.getMapExtents(),k=j.length,a=0;a<k;a++){var b=j[a];if(b.isLayerRenderable(d))b.updateQuadViewsToExtents(e,f,i,h,d,g,c);else b.flushDisplayContainers()}};this.updateQuadViewsOnRenderableTileLayerToCurrentExtents=function(a,b){var c=this.getMapExtents();if(a.isLayerRenderable(d))a.updateQuadViewsToExtents(e,f,c,h,d,g,b);else a.flushDisplayContainers()};this.updateTransformOnTileLayersToCurrentExtents=function(){for(var c=j.length,b=0;b<c;b++){var a=j[b];if(a.isLayerRenderable(d)){a.isContentDisplayed()==false&&s.updateQuadViewsOnRenderableTileLayersToCurrentExtents(false);a.updateExtentTransform(e,f,d,g)}else a.flushDisplayContainers()}};this.setContentLayer=function(a){w=a;this.addFixedContentElement=a.addFixedElement;this.removeFixedContentElement=a.removeFixedElement;this.addPathGeometry=a.addPathGeometry;this.removePathGeometry=a.removePathGeometry;this.updateContentLayerToCurrentExtents(true)};this.updateContentLayerToCurrentExtents=function(a){var b=s.getMapExtents();w.updateContainerToExtents(e,f,h,d,g,b,a)};this.addFixedContentElement=function(){};this.removeFixedContentElement=function(){};this.addPathGeometry=function(){};this.removePathGeometry=function(){};this.getZoomLevel=function(){return d};this.setMinZoomLevel=function(a){if(a>=b.getMinZoomLevel()&&a<=p)q=a};this.setMaxZoomLevel=function(a){if(a<=b.getMaxZoomLevel()&&a>=q)p=a};this.setZoomLevel=function(a){if(a>=q&&a<=p){d=a;h=Math.round(d);o=d;k=true;g=b.getProjectionUnitsPerPixel(d);l(e,f,h,d,g,i)}};this.setZoomLevelAnimate=function(a,j,c){if(a>=q&&a<=p){var m=function(a){d=a;h=Math.round(d);k=true;g=b.getProjectionUnitsPerPixel(d);l(e,f,h,d,g,i)};D(a,m,j,c)}};this.zoomDelta=function(b){var a=d+b;this.setZoomLevel(a)};this.zoomDeltaAnimate=function(c,a){var b=o+c;this.setZoomLevelAnimate(b,a)};var D=function(p,n,m,b){o=p;var c=typeof b=="undefined"?null:b;H();var j=function(){i=false;k=true;l(e,f,h,d,g,i);c!=null&&c()};i=true;F=a.animateScalar(d,o,m,n,j,"easeZoomLevelAnimate")},H=function(){if(i){F.stop(false,false);i=false}};this.zoomOverMapPoint=function(a,v){if(a>=q&&a<=p){var j=b.getHalfCircumference(),s=Math.max(Math.min(v.getX(),j),-j),t=Math.max(Math.min(v.getY(),j),-j),r=Math.pow(2,a-d),w=(s-e)/r,x=(t-f)/r;e=s-w;f=t-x;n=new c.rim.point(e,f);d=a;h=Math.round(d);o=d;if(m){u.stop(false,false);m=false}k=true;g=b.getProjectionUnitsPerPixel(d);l(e,f,h,d,g,i)}};this.zoomDeltaOverMapPointAnimate=function(w,t,u){var j=o+w,a=b.getHalfCircumference();if(j>=q&&j<=p){var s=d,m=Math.max(Math.min(t.getX(),a),-a),r=Math.max(Math.min(t.getY(),a),-a);E();var v=function(a){var j=Math.pow(2,a-s),o=(m-e)/j,p=(r-f)/j;e=m-o;f=r-p;n=new c.rim.point(e,f);s=a;d=a;h=Math.round(d);k=true;g=b.getProjectionUnitsPerPixel(d);l(e,f,h,d,g,i)};D(j,v,u)}};this.getMapCenter=function(){return n};this.setMapCenter=function(j){var c=b.getHalfCircumference();e=Math.max(Math.min(j.getX(),c),-c);f=Math.max(Math.min(j.getY(),c),-c);n=new a.point(e,f);if(m){u.stop(false,false);m=false}k=true;l(e,f,h,d,g,i)};this.setMapCenterAnimate=function(p,m,j){var b=e,c=f,o=function(j){var m=r.getX()-b,o=r.getY()-c;e=b+j*m;f=c+j*o;n=new a.point(e,f);k=true;l(e,f,h,d,g,i)};C(p,o,m,j,"easeMapCenterAnimate")};var C=function(f,i,h,d,j){var c=b.getHalfCircumference(),e=typeof d=="undefined"?null:d;E();r=new a.point(Math.max(Math.min(f.getX(),c),-c),Math.max(Math.min(f.getY(),c),-c));var g=function(){m=false;e!=null&&e()};m=true;u=a.animateScalar(0,1,h,i,g,j)};this.getPyramidLevel=function(){return h};this.setMapCenterByPixelDeltaFromPoint=function(b,c,a){s.setMapCenter(a.createOffsetBy(b*g,c*g))};this.setMapCenterByPixelDeltaFromPointAnimate=function(c,d,b,a){s.setMapCenterAnimate(b.createOffsetBy(c*g,d*g),a)};var E=function(){if(m){u.stop(false,false);m=false}};this.flyTo=function(j,c,v,u){var x=j.getX(),y=j.getY(),m=c;o=c;var t=a.point.distance(e,f,x,y),A=a.envelope.createFromPoints(n,n),p=A.createFromMargins(t,t);if(p.getArea()>0)m=Math.min(c,this.getBestFitZoomLevelByExtents(p)+1);var q=e,s=f,z=m-c,w=function(j){var m=r.getX()-q,o=r.getY()-s;e=q+j*m;f=s+j*o;n=new a.point(e,f);d=z*(-Math.pow(2*j-1,2)+1)+c;h=Math.round(d);k=true;g=b.getProjectionUnitsPerPixel(d);l(e,f,h,d,g,i)};C(j,w,v,u,"easeOutQuad")};this.getMapUnitsPerPixel=function(){return g};this.setViewExtentsInPix=function(b,a){x=b;v=a;k=true};this.getViewExtentsInPix=function(){return {w:x,h:v}};this.getMapExtents=function(){if(k==false)return A;var b=x/2*g,c=v/2*g;A=new a.envelope(e-b,f-c,e+b,f+c);k=false;return A};this.pushTileLayer=function(a){a.setNotifyTileContentChangeAction(z);j.push(a);y(a,true);a.startCleanup()};this.popTileLayer=function(){var a=j.pop();y(a,false);a.stopCleanup();return a};this.getTileLayer=function(b){for(var a=0;a<j.length;a++)if(j[a].getId()==b)return j[a];return null};this.getTileLayerCount=function(){return j.length};this.computeMapPointFromPixelLocation=function(d,h){var a=(d-x*.5)*g,b=(h-v*.5)*g;return new c.rim.point(e+a,f-b)}};a.viewmodel.prototype.getProjectedMapScale=function(){var d=this.getZoomLevel(),c=b.getProjectionUnitsPerPixel(d),a=1/b.getDpi()*.0254;return c/a};a.viewmodel.prototype.getActualMapScale=function(){var e=this.getZoomLevel(),d=this.getMapCenter(),c=b.getActualUnitsPerPixel(d,e),a=1/b.getDpi()*.0254;return c/a};a.viewmodel.prototype.getBestFitZoomLevelByExtents=function(e){var c=this.getViewExtentsInPix(),d=new a.envelope(0,0,c.w,c.h);return Math.floor(b.getBestFitZoomLevelByExtents(e,d))}})(window);(function(a){var c=a.isc=a.isc||{},b=c.rim=c.rim||{};b.gesture=function(T,P,L){var d={startX:0,startY:0,curX:0,curY:0,which:0,id:null},e={startX:0,startY:0,curX:0,curY:0,which:0,id:null},f=0,h=0,i=0,z=function(){},q=function(){},I=function(){},E=function(){},G=function(){},C=function(){},x=function(){},H=function(){},F=function(){},J=function(){},A=function(){},y=function(){},D=function(){},o=false,K=1,w=c.rim.platform.touch||c.rim.platform.ieTouch?4:0,m;if(L)m=function(a){a.stopPropagation()};else m=function(){};var l=null,n=null,Q=25,R=-1,O=8,g=[],s=null,N=333,k=document.createElement("div"),j=$(k);j.addClass("gestureContainer");j.css("z-index",P);j.attr("id","isc_rim_map_nav_div");j.bind("contextmenu",function(){return false});if(typeof k.style.msContentZooming!="undefined")k.style.msContentZooming="none";if(typeof k.style.msTouchAction!="undefined")k.style.msTouchAction="none";T.append(j);this.setNotifyPointerDownGesture=function(a){z=a};this.setNotifyPointerUpGesture=function(a){q=a};this.setNotifyDragGesture=function(a){I=a};this.setNotifyClickGesture=function(a){E=a};this.setNotifyHoverGesture=function(a){G=a};this.setNotifyDblClickGesture=function(a){C=a};this.setNotifyCtrlDblClickGesture=function(a){x=a};this.setNotifyWheelGesture=function(a){H=a};this.setNotifyFlickGesture=function(a){F=a};this.setNotifyPinchStartGesture=function(a){A=a};this.setNotifyPinchChangeGesture=function(a){y=a};this.setNotifyPinchEndGesture=function(a){D=a};this.setNotifyResizeEvent=function(a){J=a};this.setWheelDeltaPerTick=function(a){if(a>0)K=a};$(a).resize(function(){J()});j.dblclick(function(a){var b=a.pageX-j.offsetLeft,c=a.pageY-j.offsetTop;if(a.which==1)if(a.ctrlKey)x(b,c);else C(b,c)});var r=function(a){if(a.type=="mousedown"||a.type=="touchstart"||a.type=="MSPointerDown"){var m=j.offset();h=m.left;i=m.top}switch(a.type){case "mousemove":d.curX=a.pageX-h;d.curY=a.pageY-i;break;case "MSPointerMove":if(a.pointerId==d.id){d.curX=a.pageX-h;d.curY=a.pageY-i}else if(a.pointerId==e.id){e.curX=a.pageX-h;e.curY=a.pageY-i}break;case "touchmove":if(f>0){var b=a.touches[0];d.curX=b.pageX-h;d.curY=b.pageY-i}if(f>1){var c=a.touches[1];e.curX=c.pageX-h;e.curY=c.pageY-i}a.target!=k&&q(d.curX,d.curY);break;case "mousedown":d.which=a.which;f=1;d.startX=d.curX=a.pageX-h;d.startY=d.curY=a.pageY-i;break;case "mouseup":f=0;break;case "touchstart":f=a.touches?a.touches.length:0;if(f>0){var g=a.touches[0];d.which=1;d.startX=d.curX=g.pageX-h;d.startY=d.curY=g.pageY-i}if(f>1){var l=a.touches[1];e.which=1;e.startX=e.curX=l.pageX-h;e.startY=e.curY=l.pageY-i}break;case "touchend":f=0;break;case "MSPointerDown":f++;if(f==1){d.id=a.pointerId;d.which=a.which;d.startX=d.curX=a.pageX-h;d.startY=d.curY=a.pageY-i}else if(f==2){e.id=a.pointerId;e.which=a.which;e.startX=e.curX=a.pageX-h;e.startY=e.curY=a.pageY-i}break;case "MSPointerUp":f=0;break;case "MSPointerCancel":f=0}},u=function(c){o=false;if(c.target==k){c=c||a.event;c.preventDefault();m(c);var i=typeof c.originalEvent!="undefined"?c.originalEvent.ctrlKey:false;clearTimeout(s);r(c);if(f>1){B();var g=b.point.distance(d.curX,d.curY,e.curX,e.curY),h=b.point.midpoint(d.curX,d.curY,e.curX,e.curY);A(g,h)}if(d.which==1&&f<2){z(d.startX,d.startY,i);M();o=true}}};if(b.platform.ieTouch)a.addEventListener("MSPointerDown",u,false);else if(b.platform.touch)a.addEventListener("touchstart",u,false);else $(a).bind("mousedown",u);var v=function(c){c=c||a.event;if(c.target==k||!b.platform.touch){c.preventDefault();m(c);r(c);if(f>0)if(f<2){var g=d.curX-d.startX,h=d.curY-d.startY;if(g!=0||h!=0){if(o&&(Math.abs(g)>w||Math.abs(h)>w))o=false;I(-g,h)}}else{var i=b.point.distance(d.curX,d.curY,e.curX,e.curY);y(i)}else{clearTimeout(s);s=setTimeout(function(){G(d.curX,d.curY)},N)}}};if(b.platform.ieTouch)a.addEventListener("MSPointerMove",v,true);else if(b.platform.touch)a.addEventListener("touchmove",v,true);else a.addEventListener("mousemove",v,true);var p=function(a){if(f>0){a.preventDefault();m(a);var b=f;r(a);if(b==1){q(d.curX,d.curY);if(o==true)E(d.curX,d.curY);else if(d.which==1){B();S()}}else D()}};if(b.platform.ieTouch){a.addEventListener("MSPointerUp",p,false);a.addEventListener("MSPointerCancel",p,false)}else if(b.platform.touch)a.addEventListener("touchend",p,false);else $(a).bind("mouseup",p);var S=function(){var j=0,i=0,h=g.length,c,d,e,a,b;if(h>1){for(var f=0;f<h-1;f++){a=g[f];b=g[f+1];c=b.x-a.x;d=b.y-a.y;e=b.t-a.t;var k=Math.sqrt(c*c+d*d)/e;if(i>0)j+=k-i;i=k}if(j>R){a=g[0];b=g[h-1];c=b.x-a.x;d=b.y-a.y;e=b.t-a.t;F(c,d,e)}g.length=0}},t=function(){var a=d.curX,b=d.curY;if(n!=null&&a==n.x&&b==n.y)g.length=0;n={x:a,y:b,t:Date.now()};g.push(n);g.length>O&&g.shift()},M=function(){g.length=0;t();if(l==null)l=setInterval(t,Q)},B=function(){g.length==1&&t();if(l!=null){clearInterval(l);l=null}};j.mousewheel(function(c,a){var b=Math.round(a*K);H(b,d.curX,d.curY)})}})(window);(function(c){var b=c.isc=c.isc||{},a=b.rim=b.rim||{};a.digitizer=function(e){if(!(this instanceof a.digitizer))return new a.digitizer(e);var d=false,c=null,t=null,l,C,h=5,i=false,A=null,f=null,B,s,m=null,k=null,j=null,x,y,o={},r={},p=null,M=1e3,v=null,n=null,g=null,w=null,q=new a.geometryStyle;q.setDashArray("10,10");q.setOutlineColor("#FF0000");q.setOutlineOpacity(.5);var F=function(){return w!=null&&c==null},H=h*(a.platform.touch||b.rim.platform.ieTouch==true?4:2),E=b.rim.platform.touch||b.rim.platform.ieTouch?4:0;this.getIsDigitizingEnabled=function(){return d};this.beginDigitizeEnvelope=function(a){if(d==false){K();d=true;w=typeof a=="undefined"?null:a}};this.beginNewDigitizePath=function(g,f,e,a,c,b){d==false&&z(g,true,f,e,null,a,c,b)};this.beginEditDigitizePath=function(f,e,a,c,b){d==false&&z(f,true,false,null,e,a,c,b)};this.beginNewDigitizeMultipoint=function(f,e,a,c,b){d==false&&z(f,false,false,e,null,a,c,b)};this.beginEditDigitizeMultipoint=function(f,e,a,c,b){d==false&&z(f,false,false,null,e,a,c,b)};var z=function(o,i,k,j,h,b,f,e){K();d=true;l=o;C=i;v=typeof b=="undefined"?null:b;n=typeof f=="undefined"?null:f;g=typeof e=="undefined"?null:e;if(h==null){var m=new a.geometry(i,k);c=new a.styledGeometry(m,j)}else{c=h;u()}};this.pushSet=function(){c!=null&&c.pushSet([])};this.popSet=function(){if(c!=null&&c.getSetCount()>0){c.popSet();g!=null&&g();u()}};this.endDigitizePath=function(a){return J(a)};this.endDigitizeMultipoint=function(){return J(true)};var J=function(a){if(d==true){a!=true&&e.removePathGeometry(l);I();G();d=false;return c}return null};this.getDigitizeSnapshot=function(){if(d==true&&c!=null)return c.getGeometry().clone();return null};var K=function(){c=null;t=null;w=null;v=null;n=null;i=false;A=null;f=null;m=null;k=null;j=null;o={};r={}};this.interceptPointerDownGesture=function(a,b){var d=false;A=a;f=null;if(c!=null){i=true;U(a,b);if(X(a,b)==true){N();d=true}}return d};this.interceptDragGesture=function(j,k,d){var c=false,g=A.createOffsetBy(-j*d,-k*d);if(m!=null){f=g;if(n!=null){var h=n(f.getX(),f.getY(),"move");if(h instanceof a.point)f=h}e.moveFixedElement(m,f.getX(),f.getY());S(f);D();c=true}else if(F()==true){t=b.rim.envelope.createFromPoints(A,g);P();c=true}if(i&&(Math.abs(j)>E||Math.abs(k)>E))i=false;return c};this.interceptPointerUpGesture=function(p){if(c!=null){var h=p.getX(),j=p.getY();D();if(i==true){if(n!=null){var k=n(h,j,"append");if(k instanceof a.point){h=k.getX();j=k.getY()}}var o=c.addPointToLastSet(new b.rim.point(h,j));g!=null&&g();L(o.setIdx,o.idx,h,j);i=false}if(m!=null){e.removePathGeometry(l+"_edit");if(f!=null){var q=c.getSet(B);q[s]=f.getX();q[s+1]=f.getY();g!=null&&g()}}u(true);return true}else if(F()==true){e.removePathGeometry(l+"_env");w(t);d=false;return true}return false};var Q=function(){p=null;if(v!=null)if(v(B,s)==true){var a=c.getSet(B);a.splice(s,2);g!=null&&g();u();m=null;i=false}},N=function(){D();p=setTimeout(Q,M)},D=function(){p!=null&&clearTimeout(p);p=null},X=function(d,e){var b=false,g=e*H,f=function(l,f,o,p){var n=a.point.distance(o,p,d.getX(),d.getY());if(n<=g){B=l;s=f;m=Y(l,f);var e=c.getSet(l),h=e.length;if(f>=2)k=new a.point(e[f-2],e[f-1]);else if(h>=6&&c.getIsClosed()==true)k=new a.point(e[h-2],e[h-1]);if(f<=e.length-4)j=new a.point(e[f+2],e[f+3]);else if(h>=6&&c.getIsClosed()==true)j=new a.point(e[0],e[1]);i=false;b=true;return true}return false};m=null;k=null;j=null;c.foreachVertex(f);return b},U=function(b,d){var f=d*H,e=function(k,e,i,j){if(e>=2){var d=a.point.midpoint(i,j,x,y),l=a.point.distance(d.getX(),d.getY(),b.getX(),b.getY());if(l<=f){var h=c.getSet(k);h.splice(e,0,d.getX());h.splice(e+1,0,d.getY());g!=null&&g();u();return true}}x=i;y=j;return false};c.foreachVertex(e)},P=function(){if(t!=null){var c=t.toGeometry(),b=new a.styledGeometry(c,q);e.addPathGeometry(b,l+"_env")}},u=function(a){C&&e.addPathGeometry(c,l);if(a!=true){I();V()}if(C){G();R()}},S=function(c){if(C&&(k!=null||j!=null)){var d=new a.geometry(true,false),b=[];if(k!=null){b.push(k.getX());b.push(k.getY())}b.push(c.getX());b.push(c.getY());if(j!=null){b.push(j.getX());b.push(j.getY())}d.pushSet(b);var f=new a.styledGeometry(d,q);e.addPathGeometry(f,l+"_edit")}},V=function(){c!=null&&c.foreachVertex(L)},I=function(){for(var a in o){var b=o[a];e.removeFixedElement(b);delete o[a]}},L=function(b,c,f,g){var d="node"+b+"_"+c,a=T();o[d]=a;e.addFixedElement(a,f,g)},Y=function(a,b){var c="node"+a+"_"+b;return o[c]},R=function(){c!=null&&c.foreachVertex(W)},W=function(h,c,f,g){if(c>=2){var i="node"+h+"_"+c,b=O();r[i]=b;var d=a.point.midpoint(f,g,x,y);e.addFixedElement(b,d.getX(),d.getY())}x=f;y=g},G=function(){for(var a in r){var b=r[a];e.removeFixedElement(b);delete r[a]}},T=function(){var d="http://www.w3.org/2000/svg",b=document.createElementNS(d,"svg"),g=(h+1)*2;b.setAttribute("height",g);b.setAttribute("width",g);b.setAttribute("style","position: absolute; z-index: 1000; cursor: move;");var f=$(b);f.css("left",-(h+1)+"px");f.css("top",-(h+1)+"px");var a=document.createElementNS(d,"ellipse");a.setAttribute("cx",h+1);a.setAttribute("cy",h+1);a.setAttribute("rx",h);a.setAttribute("ry",h);a.setAttribute("style","stroke-opacity: 1; stroke-width: 1; fill-opacity: 1;");var e=$(a);e.css("stroke",c.getOutlineColor());e.css("fill",c.getFillColor());b.appendChild(a);return b},O=function(){var e="http://www.w3.org/2000/svg",b=document.createElementNS(e,"svg"),d=(h-1)*2;b.setAttribute("height",d);b.setAttribute("width",d);b.setAttribute("style","position: absolute; z-index: 1000; cursor: move;");var f=$(b);f.css("left",-d/2+"px");f.css("top",-d/2+"px");var a=document.createElementNS(e,"rect");a.setAttribute("x",0);a.setAttribute("y",0);a.setAttribute("width",d);a.setAttribute("height",d);a.setAttribute("style","stroke-opacity: 0.5; stroke-width: 1; fill-opacity: 0.5;");var g=$(a);g.css("stroke",c.getFillColor());g.css("fill",c.getOutlineColor());b.appendChild(a);return b}}})(window);(function(d){var b=d.isc=d.isc||{},a=b.rim=b.rim||{},c=a.sphericalMercator=a.sphericalMercator||{},e=a.content=a.content||{};a.binder=function(){if(!(this instanceof a.binder))return new a.binder;var P,h,D,k,d,g,f,q=0,r=0,O=this,l=c.getCircumference(),m=l,n=l,t=-l,u=-l,N=0,A=0,I=0,y,w=false,C=333,W=1250,Z=300,S,M,B=false,K=null,R=350,J=function(){},z=null,p=null,o=128;this.setContentExtentsMarginInPixels=function(a){o=a;d.setContentExtentsMarginInPixelsOnAllLayers(a)};var Y=0,U=10,V=0,x=10,ab=5,H,F,G,s,j,i;this.bind=function(p,n,t){if(p&&n instanceof b.rim.viewmodel){d=n;H=d.setMapCenterByPixelDeltaFromPoint;F=d.updateQuadViewsOnRenderableTileLayersToCurrentExtents;G=d.updateTransformOnTileLayersToCurrentExtents;s=d.updateContentLayerToCurrentExtents;j=d.computeMapPointFromPixelLocation;P=document.createElement("div");h=$(P);h.css("position","relative");h.css("width","100%");h.css("height","100%");h.css("overflow-x","hidden");h.css("overflow-y","hidden");$(p).append(h);r=h.width();q=h.height();d.setViewExtentsInPix(r,q);var u=document.createElement("div"),c=$(u);c.css("position","absolute");c.css("z-index",Y);c.css("left","50%");c.css("top","50%");$(h).append(c);D=document.createElement("div");k=$(D);k.css("position","absolute");k.css("z-index",V);k.css("left","0px");k.css("top","0px");c.append(k);g=new a.gesture(h,U,t);g.setNotifyPointerDownGesture(this.handlePointerDownGesture);g.setNotifyPointerUpGesture(this.handlePointerUpGesture);g.setNotifyDblClickGesture(this.handleDblClick);g.setNotifyCtrlDblClickGesture(this.handleCtrlDblClick);g.setNotifyDragGesture(this.handleDragGesture);g.setNotifyWheelGesture(this.handleWheelGesture);g.setNotifyFlickGesture(this.handleFlickAction);g.setNotifyResizeEvent(this.handleResize);g.setNotifyClickGesture(this.handlePointerClick);g.setNotifyHoverGesture(this.handlePointerHover);g.setNotifyPinchStartGesture(this.handlePinchStartGesture);g.setNotifyPinchChangeGesture(this.handlePinchChangeGesture);g.setNotifyPinchEndGesture(this.handlePinchEndGesture);var m=new e.layer(c,ab,o);d.setContentLayer(m);f=new a.digitizer(m);i=f.getIsDigitizingEnabled;d.setNotifyTileContentConfigurationChangeAction(Q);d.setNotifyTileContentChangeAction(X);d.setNotifyExtentChangeAction(bb);this.createStyles();try{var l=a.platform.getDpi();l>0&&a.sphericalMercator.setDpi(l)}catch(v){}}};var Q=function(a,b){if(b){a.setContentExtentsMarginInPixels(o);a.setParentContainer(D);a.setZindex(x);a.addDisplayContainers();x+=10}else{a.removeDisplayContainers();x-=10}O.redraw()},X=function(a,b){switch(b){case "visibility":a.flushDisplayContainers();break;case "opacity":a.flushContent();a.flushDisplayContainers();break;case "zoom level constraint":a.isLayerRenderable()==false&&a.flushDisplayContainers();break;case "descriptor":a.flushContent();a.flushDisplayContainers();break;case "requestor":a.flushContent();a.flushDisplayContainers();break;case "renderer":a.reRenderContent();return}d.updateQuadViewsOnRenderableTileLayerToCurrentExtents(a,true)},T=function(){var a=c.deprojectToLatLon(new b.rim.point(m,n)),h=d.getActualMapScale(),g=d.getProjectedMapScale(),f=d.getMapUnitsPerPixel(),e=d.getMapExtents(),i={centerX:m,centerY:n,centerLat:a.getY(),centerLon:a.getX(),zoomLevel:N,mapScale:h,mapScaleProjected:g,mapUnitsPerPixel:f,extents:e};J(i)},bb=function(f,g,e,h,a,d){m=f;n=g;N=h;A=e;y=a;clearTimeout(K);K=setTimeout(T,R);var i=Math.abs(m-t),j=Math.abs(n-u),c=Math.abs(A-I),b=o*a;if((i>b||j>b||c>0)&&w==false&&d==false){t=m;u=n;I=A;F(false);s(c>=0)}else{G();s(false)}};this.redraw=function(){if(d){t=-l;u=-l;d.forceNotifyExtentChangeAction()}};this.beginDigitizeEnvelope=function(a){f.beginDigitizeEnvelope(a)};this.beginNewDigitizePath=function(g,e,d,a,c,b){f.beginNewDigitizePath(g,e,d,a,c,b)};this.beginEditDigitizePath=function(e,d,a,c,b){f.beginEditDigitizePath(e,d,a,c,b)};this.beginNewDigitizeMultipoint=function(e,d,a,c,b){f.beginNewDigitizeMultipoint(e,d,a,c,b)};this.beginEditDigitizeMultipoint=function(e,d,a,c,b){f.beginEditDigitizeMultipoint(e,d,a,c,b)};this.endDigitizePath=function(a){return f.endDigitizePath(a)};this.endDigitizeMultipoint=function(){return f.endDigitizeMultipoint()};this.getDigitizeSnapshot=function(){return f.getDigitizeSnapshot()};this.pushSetOnDigitizePath=function(){f.pushSet()};this.popSetFromDigitizePath=function(){return f.popSet()};this.isDigitizingEnabled=function(){return i()};this.setNotifyExtentChangeComplete=function(a){J=a};this.setNotifyPointerClick=function(a){z=a};this.setNotifyPointerHover=function(a){p=a};this.isHoverEnabled=function(){return p!=null};this.handlePointerDownGesture=function(a,b,e){S=j(a,b);if(e==true){var c=function(a){if(a!=null&&a.getArea()>0){d.setZoomLevelAnimate(d.getBestFitZoomLevelByExtents(a),500);d.setMapCenterAnimate(a.getCenter(),500)}};f.beginDigitizeEnvelope(c)}if(i()==true){var g=j(a,b);if(f.interceptPointerDownGesture(g,y)==true)return}M=d.getMapCenter()};this.handlePointerUpGesture=function(b,c){if(i()==true){var a=j(b,c);if(f.interceptPointerUpGesture(a)==true)return}};this.handleDragGesture=function(a,b){if(i()==true)if(f.interceptDragGesture(a,b,y)==true){B=true;return}H(a,b,M)};this.handleWheelGesture=function(a,c,e){var b=j(c,e);d.zoomDeltaOverMapPointAnimate(a,b,C)};this.handlePointerClick=function(b,c){if(z!=null&&i()==false){var a=j(b,c);z(a)}};this.handlePointerHover=function(b,c){if(p!=null&&i()==false){var a=j(b,c);p(a)}};this.handleDblClick=function(){i()==false&&d.zoomDeltaAnimate(1,C)};this.handleCtrlDblClick=function(){i()==false&&d.zoomDeltaAnimate(-1,C)};this.handleFlickAction=function(c,e,b){if(B==false){var f=d.getMapCenter(),a=Z/b;d.setMapCenterByPixelDeltaFromPointAnimate(c*-a,e*a,f,W)}B=false};this.handleResize=function(){var b=h.width(),a=h.height();if(b>0&&a>0){r=b;q=a;d.setViewExtentsInPix(r,q);O.redraw()}};var v,L,E;this.handlePinchStartGesture=function(b,a){w=true;v=b;L=d.getZoomLevel();E=j(a.getX(),a.getY())};this.handlePinchChangeGesture=function(a){if(v>0){var b=Math.log(a/v)/Math.log(2);d.zoomOverMapPoint(L+b,E)}};this.handlePinchEndGesture=function(){d.zoomOverMapPoint(Math.round(d.getZoomLevel()),E);w=false;d.forceNotifyExtentChangeAction()};this.createStyles=function(){var b=document.createElement("style");b.type="text/css";var a="",d=".gestureContainer { position: absolute; left: 0px; top: 0px; width: inherit; height: inherit; opacity: 0; background: black; white-space: nowrap; line-height: 0; display: block;} ";a+=d;var e=".tileContainer { position: absolute; left: 0px; top: 0px; white-space: nowrap; line-height: 0; display: block; -transform-origin: 50% 50%; -ms-transform-origin: 50% 50%; -webkit-transform-origin: 50% 50%; -moz-transform-origin: 50% 50%; -o-transform-origin: 50% 50%; } ";a+=e;var c=".contentContainer { position: absolute; left: 0px; top: 0px; white-space: nowrap; line-height: 0; display: block; } ";a+=c;var f=".canvasQuadView { position: absolute; display: block; border: 0px none ; margin: 0px; padding: 0px; line-height: 0; opacity: 0; transition: opacity 350ms; -moz-transition: opacity 350ms; -webkit-transition: opacity 350ms; -o-transition: opacity 350ms; } ";a+=f;if(b.styleSheet)b.styleSheet.cssText=a;else b.appendChild(document.createTextNode(a));document.getElementsByTagName("head")[0].appendChild(b)}}})(window);(function(c){var b=window.isc=window.isc||{},a=b.rim=b.rim||{};c.widget("ui.rimMap",{options:{mapCenterOnCreate:{x:0,y:0},zoomLevelOnCreate:1,onGeoLocated:function(){},stopPointerEventPropagation:true},_create:function(){var b=new a.point(this.options.mapCenterOnCreate.x,this.options.mapCenterOnCreate.y),d=Math.round(this.options.zoomLevelOnCreate);this.rimViewModel=new a.viewmodel(b,d,null);this.rimBinder=new a.binder;var c=this;this.rimBinder.bind(this.element[0],this.rimViewModel,this.options.stopPointerEventPropagation);navigator&&navigator.geolocation&&b.getX()==0&&b.getY()==0&&navigator.geolocation.getCurrentPosition(function(b){var e=b.coords.latitude,f=b.coords.longitude,d=a.sphericalMercator.projectFromLatLon(new a.point(f,e));c.rimViewModel.setMapCenter(d);c.options.onGeoLocated()})},getMapCenter:function(){return this.rimViewModel.getMapCenter()},setMapCenter:function(a){this.rimViewModel.setMapCenter(a)},setMapCenterAnimate:function(c,b,a){this.rimViewModel.setMapCenterAnimate(c,b,a)},setMapCenterToGeolocationAnimate:function(c,b){var d=this;navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var g=e.coords.latitude,h=e.coords.longitude,f=a.sphericalMercator.projectFromLatLon(new a.point(h,g));d.rimViewModel.setMapCenterAnimate(f,c,b)})},getZoomLevel:function(){return this.rimViewModel.getZoomLevel()},setZoomLevel:function(a){this.rimViewModel.setZoomLevel(Math.round(a))},setMinZoomLevel:function(a){this.rimViewModel.setMinZoomLevel(Math.round(a))},setMaxZoomLevel:function(a){this.rimViewModel.setMaxZoomLevel(Math.round(a))},setZoomLevelAnimate:function(c,b,a){this.rimViewModel.setZoomLevelAnimate(Math.round(c),b,a)},zoomDelta:function(a){this.rimViewModel.zoomDelta(Math.round(a))},zoomDeltaAnimate:function(b,a){this.rimViewModel.zoomDeltaAnimate(Math.round(b),a)},flyTo:function(c,d,b,a){this.rimViewModel.flyTo(c,d,b,a)},getMapExtents:function(){return this.rimViewModel.getMapExtents()},getMapUnitsPerPixel:function(){return this.rimViewModel.getMapUnitsPerPixel()},getViewExtentsInPix:function(){return this.rimViewModel.getViewExtentsInPix()},getProjectedMapScale:function(){return this.rimViewModel.getProjectedMapScale()},getActualMapScale:function(){return this.rimViewModel.getActualMapScale()},getBestFitZoomLevelByExtents:function(a){return this.rimViewModel.getBestFitZoomLevelByExtents(a)},redraw:function(){this.rimBinder.redraw()},resize:function(){this.rimBinder.handleResize()},pushTileLayer:function(a){this.rimViewModel.pushTileLayer(a)},popTileLayer:function(){return this.rimViewModel.popTileLayer()},getTileLayerCount:function(){return this.rimViewModel.getTileLayerCount()},getTileLayer:function(a){return this.rimViewModel.getTileLayer(a)},computeMapPointFromPixelLocation:function(a,b){return this.rimViewModel.computeMapPointFromPixelLocation(a,b)},addFixedContentElement:function(d,b,c,a){this.rimViewModel.addFixedContentElement(d,b,c,a)},removeFixedContentElement:function(a){this.rimViewModel.removeFixedContentElement(a)},addPathGeometry:function(a,b){return this.rimViewModel.addPathGeometry(a,b)},removePathGeometry:function(a){this.rimViewModel.removePathGeometry(a)},beginDigitizeEnvelope:function(a){this.rimBinder.beginDigitizeEnvelope(a)},beginNewDigitizePath:function(f,e,d,a,c,b){this.rimBinder.beginNewDigitizePath(f,e,d,a,c,b)},beginEditDigitizePath:function(e,d,a,c,b){this.rimBinder.beginEditDigitizePath(e,d,a,c,b)},endDigitizePath:function(a){return this.rimBinder.endDigitizePath(a)},beginNewDigitizeMultipoint:function(e,d,a,c,b){this.rimBinder.beginNewDigitizeMultipoint(e,d,a,c,b)},beginEditDigitizeMultipoint:function(e,d,a,c,b){this.rimBinder.beginEditDigitizeMultipoint(e,d,a,c,b)},endDigitizeMultipoint:function(){return this.rimBinder.endDigitizeMultipoint()},getDigitizeSnapshot:function(){return this.rimBinder.getDigitizeSnapshot()},pushSetOnDigitizePath:function(){this.rimBinder.pushSetOnDigitizePath()},popSetFromDigitizePath:function(){return this.rimBinder.popSetFromDigitizePath()},isDigitizingEnabled:function(){return this.rimBinder.isDigitizingEnabled()},setExtentChangeCompleteAction:function(a){this.rimBinder.setNotifyExtentChangeComplete(a)},setPointerClickAction:function(a){this.rimBinder.setNotifyPointerClick(a)},setPointerHoverAction:function(a){this.rimBinder.setNotifyPointerHover(a)},setContentExtentsMarginInPixels:function(a){this.rimBinder.setContentExtentsMarginInPixels(a)}})})(jQuery);(function(b){var c=b.isc=b.isc||{},d=c.rim=c.rim||{},a=d.tile=d.tile||{};a.requestorOpen=function(e,d){if(!(this instanceof a.requestorOpen))return new a.requestorOpen(e,d);var f=e||"http://{0}.tile.openstreetmap.org/{1}/{2}/{3}.png",c=d||["a","b","c"],b=0;this.getEndpoint=function(){return f};this.formatEndpoint=function(a,e){var d;if(typeof e=="undefined")d=String.format(this.getEndpoint(),c[b],a.getLevel(),a.getX(),a.getY());else d=String.format(this.getEndpoint(),c[b],a.getLevel(),a.getX(),a.getY(),e);b++;if(b>=c.length)b=0;return d}};a.requestorOpen.prototype=new a.requestor;a.requestorOpen.constructor=a.requestorOpen})(window);(function(b){var c=b.isc=b.isc||{},d=c.rim=c.rim||{},a=d.tile=d.tile||{};a.requestorGoogle=function(){if(!(this instanceof a.requestorGoogle))return new a.requestorGoogle;var c=["0","1"],b=0,d="109";this.formatEndpoint=function(f,a){if(a==null)a="r";else a=a.toLowerCase();var g=f.getX(),h=f.getY(),j=f.getLevel(),k="Galileo",m=(3*g+h)%8,i=k.substr(0,m),e=null;switch(a){case null:case "h":case "ro":case "r":var l={h:"y",ro:"h",r:"m"},n="http://mt{0}.google.com/vt/lyrs={1}&hl=en&src=app&x={2}&y={3}&z={4}&s={5}";e=String.format(n,c[b],l[a],g,h,j,i);break;case "a":var o="http://khm{0}.google.com/kh/v={5}&src=app&x={1}&y={2}&z={3}&s={4}";e=String.format(o,c[b],g,h,j,i,d)}b++;if(b>=c.length)b=0;return e}};a.requestorGoogle.prototype=new a.requestor;a.requestorGoogle.constructor=a.requestorGoogle})(window);(function(c){var b=c.isc=c.isc||{},d=b.rim=b.rim||{},a=d.tile=d.tile||{};a.descriptorMDNRestMap=function(t){var s=t,o="9.0",e=0,r=["png","png8","jpg"],n=1,d=0,q=["None","ReadOnly","ReadWrite","ForceWrite","Default"],m=null,l=false,j="00000000",f={},h={},i={},c={},g=",",p=null,b=function(){},a=false;this.setSuspendDescriptorChangeNotifications=function(c){a=c;!a&&b()};this.setNotifyDescriptorChangeAction=function(a){b=a};this.getMapId=function(){return s};this.getVersion=function(){return o};this.setVersion=function(a){o=a};this.getImageType=function(){return r[e]};this.setImageType=function(c){if(c.toLowerCase())c=c.toLowerCase();switch(c){case "png":e=0;break;case "png8":e=1;break;case "jpg":e=2;break;case "jpeg":e=2;break;default:e=0}!a&&b()};this.getBleedRatio=function(){return n};this.setBleedRatio=function(c){c=Math.min(Math.max(c,1),2);n=c;!a&&b()};this.getMapCacheOption=function(){return q[d]};this.setMapCacheOption=function(c){if(c.toLowerCase())c=c.toLowerCase();switch(c){case "none":d=0;break;case "readonly":d=1;break;case "readwrite":d=2;break;case "forcewrite":d=2;break;case "default":d=3;break;default:d=0}!a&&b()};this.getMapCacheName=function(){return m};this.setMapCacheName=function(c){m=c;!a&&b()};this.getUseQuadKeyForMapCacheName=function(){return l};this.setUseQuadKeyForMapCacheName=function(c){l=c;!a&&b()};this.getBackgroundColorStr=function(){return j};this.setBackgroundColor=function(c,f,e,d){j=k(c,f,e,d);!a&&b()};this.getIsBackgroundTransparent=function(){if(j[0]=="0"&&j[1]=="0")return true;return false};this.setLayerVisibility=function(d,c){f[d]=c;!a&&b()};this.getLayerVisibility=function(a){if(a in f)return f[a];return false};this.getLayerVisibilityRestStr=function(){var a=[];for(key in f){a.push(key);if(f[key]==true)a.push("1");else a.push("0")}return a.join(",")};this.setLayerOutline=function(c,f,j,i,g,e){var d=k(f,j,i,g);h[c]={color:d,thickness:e};!a&&b()};this.getLayerOutline=function(a){if(a in h)return h[a];return null};this.getLayerOutlineRestStr=function(){var a=[];for(key in h){a.push(key);var b=h[key];a.push(b.color);a.push(b.thickness)}return a.join(",")};this.setLayerFill=function(c,d,g,f,e){i[c]=k(d,g,f,e);!a&&b()};this.getLayerFill=function(a){if(a in i)return i[a];return null};this.getLayerFillRestStr=function(){var a=[];for(key in i){a.push(key);a.push(i[key])}return a.join(",")};this.setLayerWhere=function(f,e,d){if(typeof d=="undefined")d=false;c[f]={w:e!=null?encodeURIComponent(e):null,m:d};!a&&b()};this.setLayerWhereSep=function(a){if(a&&(a+"").length==1)g=a+""};this.getLayerWhereSep=function(){return g};this.getLayerWhere=function(a){if(a in c&&c[a])return decodeURIComponent(c[a].w);return null};this.getLayerWhereRestStr=function(){var a=[];for(key in c){var b=c[key];if(b.w!=null){a.push(key);a.push(b.w)}}return a.join(g)};this.getLayerWhereSepRestStr=function(){if(g==",")return null;return g};this.getLayerWhereMergeRestStr=function(){var a=false,d=[];for(key in c){var b=c[key];if(b!=null){var e="0";if(b.m){a=true;e="1"}d.push(e)}}if(a)return d.join(",");return null};this.setTag=function(c){p=c==null?null:c+"";!a&&b()};this.getTag=function(){return p};var k=function(a,d,c,b){a=Math.min(Math.max(a,0),255);d=Math.min(Math.max(d,0),255);c=Math.min(Math.max(c,0),255);b=Math.min(Math.max(b,0),255);return a.toString(16)+d.toString(16)+c.toString(16)+b.toString(16)}};a.descriptorMDNRestFeature=function(j,h){var i=j,g=h,e=[],f="9.0",d=1,b=true,c=true,a=function(){};this.getMapId=function(){return i};this.getlayerId=function(){return g};this.getFieldNames=function(){return e};this.setFieldNames=function(a){e=a};this.getVersion=function(){return f};this.setVersion=function(a){f=a};this.getBleedRatio=function(){return d};this.setBleedRatio=function(b){b=Math.min(Math.max(b,1),2);d=b;a()};this.getClipToRenderBounds=function(){return b};this.setClipToRenderBounds=function(a){b=a};this.getSimplifyEnabled=function(){return c};this.setSimplifyEnabled=function(a){c=a};this.setNotifyDescriptorChangeAction=function(b){a=b}};a.requestorMDNRest=function(f){if(!(this instanceof a.requestorMDNRest))return new a.requestorMDNRest(f);var d="json",e=15000,c;this.getIsRestImage=function(){return c};this.setIsRestImage=function(a){c=a};var b=f||"http://localhost/MapDotNetUX9.0/";if(b.length&&b.length>0&&b[b.length-1]!="/")b=b.concat("/");this.getDataFormat=function(){return d};this.setDataFormat=function(a){d=a};this.getEndpoint=function(){return b};this.getTimeoutMs=function(){return e};this.setTimeoutMs=function(a){e=a}};a.requestorMDNRest.prototype=new a.requestor;a.requestorMDNRest.constructor=a.requestorMDNRest;a.requestorMDNRest.prototype.getIsRestImage=function(){return this.getIsRestImage()};a.requestorMDNRest.prototype.getDataFormat=function(){return this.getDataFormat()};a.requestorMDNRest.prototype.formatEndpoint=function(e,c){if(c instanceof a.descriptorMDNRestMap){this.setIsRestImage(true);var r="{0}REST/{1}/Map/{2}/Image/Qkey/{3}/256,256/{4}?BleedRatio={5}&MapBackgroundColor={6}&MapCacheOption={7}",d=String.format(r,this.getEndpoint(),c.getVersion(),c.getMapId(),e.getKey(),c.getImageType(),c.getBleedRatio(),c.getBackgroundColorStr(),c.getMapCacheOption()),n=c.getMapCacheName();if(c.getUseQuadKeyForMapCacheName())d+="&MapCacheName="+e.getKey();else if(n)d+="&MapCacheName="+n;var l=c.getLayerVisibilityRestStr();if(l!=null&&l.length>0)d+="&LayerVisibility="+l;var h=c.getLayerOutlineRestStr();if(h!=null&&h.length>0)d+="&LayerOutlinePen="+h;var k=c.getLayerFillRestStr();if(k!=null&&k.length>0)d+="&LayerFillBrush="+k;var j=c.getLayerWhereRestStr();if(j!=null&&j.length>0)d+="&LayerWhere="+j;var g=c.getLayerWhereSepRestStr();if(g!=null&&g.length>0)d+="&LayerWhereSep="+g;var f=c.getLayerWhereMergeRestStr();if(f!=null&&f.length>0)d+="&LayerWhereMerge="+f;var m=c.getTag();if(m!=null&&m.length>0)d+="&tag="+m;return d}else if(c instanceof a.descriptorMDNRestFeature){this.setIsRestImage(false);var q="{0}REST/{1}/Map/{2}/Features/{3}/Qkey/{4}?Format=json&ReturnShapes=1&BleedRatio={5}&ClipToRenderBounds={6}",i=String.format(q,this.getEndpoint(),c.getVersion(),c.getMapId(),c.getlayerId(),e.getKey(),c.getBleedRatio(),c.getClipToRenderBounds()?"1":"0"),o=c.getFieldNames();if(o.length&&o.length>0){var p=c.getFieldNames().join(",");i+="&Fields="+p}if(c.getSimplifyEnabled()==true){var s=e.getEnvelope().getWidth()/b.rim.sphericalMercator.getTileSizePix();i+="&UnitsPerPixel="+s}return i}return null}})(window);(function(o){var a=o.isc=o.isc||{},d=a.rim=a.rim||{};d.geometry=function(e,c){if(!(this instanceof d.geometry))return new d.geometry(e,c);var b=[];this.factoryPoly=function(){return this.getIsClosed()?new a.rim.geometry.polygon(this):new a.rim.geometry.polyline(this)};this.createFromTransformed=function(j,k){for(var l=b.length,i=new d.geometry(e,c),h=0;h<l;h++){for(var g=b[h],f=[],m=g.length,a=0;a<m;a+=2){f.push(j(g[a]));f.push(k(g[a+1]))}i.pushSet(f)}return i};this.clone=function(){for(var j=b.length,i=new d.geometry(e,c),h=0;h<j;h++){for(var g=b[h],f=[],k=g.length,a=0;a<k;a+=2){f.push(g[a]);f.push(g[a+1])}i.pushSet(f)}return i};this.foreachVertex=function(e){for(var f=b.length,c=0;c<f;c++)for(var d=b[c],g=d.length,a=0;a<g;a+=2)if(e(c,a,d[a],d[a+1])==true)return};this.getBounds=function(){for(var l=b.length,h=Number.MAX_VALUE,i=Number.MAX_VALUE,f=-Number.MAX_VALUE,g=-Number.MAX_VALUE,k=0;k<l;k++)for(var j=b[k],m=j.length,c=0;c<m;c+=2){var d=j[c],e=j[c+1];if(d>f)f=d;if(d<h)h=d;if(e>g)g=e;if(e<i)i=e}return new a.rim.envelope(h,i,f,g)};this.getIsPath=function(){return e};this.getIsClosed=function(){return c};this.getSetCount=function(){return b.length};this.getSet=function(a){var c=b.length;if(typeof a=="undefined")a=c-1;if(a>=0&&a<c)return b[a];return null};this.pushSet=function(a){b.push(a)};this.popSet=function(){return b.pop()};this.toSvgPathData=function(){if(e==true){for(var a=[],i=b.length,g=0;g<i;g++){var f=b[g],h=f.length;if(h>=4){a.push("M");for(var d=0;d<h;d+=2){d>0&&a.push("L");a.push(f[d]+","+f[d+1]+" ")}c==true&&a.push("z")}}if(a.length>0)return a.join("")}return null};this.addPointToLastSet=function(e){var a=b.length;if(a==0){b.push([]);a++}var d=a-1,c=b[d];c.push(e.getX());c.push(e.getY());return {setIdx:d,idx:c.length-2}};this.isValid=function(){if(e==true){for(var g=c==true?6:4,d=b.length,a=0;a<d;a++){var f=b[a];if(f.length>=g)return true}return false}return true};this.toString=function(){try{var h=b.length;if(h>0){var a=[],j=")";if(e==true)if(c==true){a.push("POLYGON((");j="))"}else if(h>1){a.push("MULTILINESTRING((");j="))"}else a.push("LINESTRING(");else{var k=b[0].length;if(k<2)throw"invalid point";else if(k>2)a.push("MULTIPOINT(");else a.push("POINT(")}for(var i=0;i<h;i++){for(var d=b[i],g=d.length,f=0;f<g;f+=2){a.push(d[f]+" ");if(f<g-2)a.push(d[f+1]+",");else a.push(d[f+1])}if(c==true&&g>=6&&(d[0]!=d[g-2]||d[1]!=d[g-1])){a.push(","+d[0]+" ");a.push(d[1])}i<h-1&&a.push("),(")}a.push(j);return a.join("")}else throw"empty shape"}catch(l){return l.message}};this.toWkt=this.toString;this.findNearestVertex=function(k){for(var l=k.getX(),m=k.getY(),c={setIdx:null,ptIdx:null,pt:null,distance:null},f=Infinity,n=b.length,e=0;e<n;e++)for(var g=b[e],o=g.length,d=0;d<o;d+=2){var i=g[d],j=g[d+1],h=Math.pow(l-i,2)+Math.pow(m-j,2);if(h<f){f=h;c.setIdx=e;c.ptIdx=d;c.pt=new a.rim.point(i,j);c.distance=f}}if(c.distance)c.distance=Math.sqrt(c.distance);return c};this.findNearestSegment=function(v,s){if(typeof s=="undefined")if(!e)return this.findNearestVertex(v);else s=c;for(var t=v.getX(),u=v.getY(),d={setIdx:null,ptIdx:null,pt:null,distance:null},q=Infinity,w=b.length,p=0;p<w;p++){var f=b[p],o=f.length,h;if(o>=4)for(var g=0;g<o;g+=2){var i=f[g],j=f[g+1],k,l;if(g==o-2&&s==true){k=f[0];l=f[1]}else if(g==o-2)break;else{k=f[g+2];l=f[g+3]}var r=((t-i)*(k-i)+(u-j)*(l-j))/(Math.pow(i-k,2)+Math.pow(j-l,2)),m,n;if(r<0){m=i;n=j}else if(r>1){m=k;n=l}else{m=i+r*(k-i);n=j+r*(l-j)}h=Math.pow(t-m,2)+Math.pow(u-n,2);if(h<q){q=h;d.setIdx=p;d.ptIdx=g;d.pt=new a.rim.point(m,n);d.distance=h}}else if(o==2){h=Math.pow(t-f[0],2)+Math.pow(u-f[1],2);if(h<q){q=h;d.setIdx=p;d.ptIdx=0;d.pt=a.rim.point(f[0],f[1]);d.distance=h}}}if(d.distance)d.distance=Math.sqrt(d.distance);return d};this.getLabelingPoint=function(t){t=t||0;var c=this.getSet(t);if(c.length==2)return new a.rim.point(c[0],c[1]);else if(this.getIsPath())if(this.getIsClosed()){for(var p=c.length,n=c[0],o=c[1],b=2;b+1<p;b+=2){if(c[b]<n)n=c[b];if(c[b+1]<o)o=c[b+1]}var d=[];for(b=0;b+1<p;b+=2){d[b]=c[b]-n;d[b+1]=c[b+1]-o}var u=0,x=0,y=0,i;for(b=0,i=p-2;b<p;i=b,b+=2){var v=d[b]*d[i+1]-d[i]*d[b+1];u+=v;x+=(d[b]+d[i])*v;y+=(d[b+1]+d[i+1])*v}var g=[x/(3*u)+n,y/(3*u)+o];if(!h(g,this,0))g=this.findNearestSegment(new a.rim.point(g[0],g[1])).pt;else g=new a.rim.point(g[0],g[1]);return g}else{var e=0,j=[];for(b=0;b<c.length-2;b+=2){var A=Math.pow(c[b+2]-c[b+0],2),B=Math.pow(c[b+3]-c[b+1],2);j[b]=Math.sqrt(A+B);e=e+j[b]}e=.5*e;var f=0;for(b=0;e>=0;b=b+2){e=e-j[b];f=f+2}var m=(e+j[f-2])/j[f-2];return new a.rim.point((1-m)*c[f-2]+m*c[f+0],(1-m)*c[f-1]+m*c[f+1])}else if(c.length>=6){var q=c[0],r=c[1];for(b=2;b<c.length-2;b+=2){q+=c[b];r+=c[b+1]}q/=c.length/2;r/=c.length/2;var s=0,k=q-c[0],l=r-c[1],w=k*k+l*l;for(b=2;b<c.length-2;b+=2){k=q-c[b];l=r-c[b+1];var z=k*k+l*l;if(z<w){w=z;s=b}}return new a.rim.point(c[s],c[s+1])}else if(c.length>=2)return new a.rim.point(c[0],c[1]);return null}};d.geometry.polyline=function(b){if(b instanceof a.rim.styledGeometry)b=b.getGeometry();this.createFromTransformed=b.createFromTransformed;this.clone=function(){return new a.rim.geometry.polyline(b.clone())};this.getGeometry=function(){return b};this.foreachVertex=b.foreachVertex;this.getBounds=b.getBounds;this.getIsClosed=function(){return false};this.getIsPath=function(){return true};this.getLineCount=b.getSetCount;this.getSetCount=b.getSetCount;this.getLine=b.getSet;this.getSet=b.getSet;this.pushLine=b.pushSet;this.pushSet=b.pushSet;this.popLine=b.popSet;this.popSet=b.popSet;this.toSvgPathData=b.toSvgPathData;this.addPointToLastLine=b.addPointToLastSet;this.isValid=b.isValid;this.toString=b.toString;this.getProjectedDistance=function(d){var g=this.getLineCount();d=d||g-1;for(var b=this.getLine(d),c=0,a=0;a<b.length-2;a+=2){var e=Math.pow(b[a+2]-b[a+0],2),f=Math.pow(b[a+3]-b[a+1],2);c=c+Math.sqrt(e+f)}return c};this.getLabelingPoint=b.getLabelingPoint;this.getActualDistance=function(i){var d=this.clone(),n=d.getLineCount();i=i||n-1;for(var c=d.getLine(i),k=c.length,g=c[0],e=c[0],h=c[1],f=c[1],b=2;b<k;b++)if(b%2==0){e=Math.max(e,c[b]);g=Math.min(g,c[b])}else{f=Math.max(f,c[b]);h=Math.min(h,c[b])}var l=.5*(e+g),m=.5*(f+h);for(b=0;b<k;b+=2){var j=a.rim.sphericalMercator.getActualShapeScaleTransform(c[b+1]);c[b]=j*(c[b]-l);c[b+1]=j*(c[b+1]-m)}return d.getProjectedDistance()};this.findNearestVertex=b.findNearestVertex;this.findNearestSegment=function(a){return b.findNearestSegment(a,false)};this.intersects=function(a){var b=Math.pow(10,-4);if(a.getIsClosed())return j(this,a,b);else return f(this,a,b)}};d.geometry.polygon=function(b){if(b instanceof a.rim.styledGeometry)b=b.getGeometry();this.createFromTransformed=b.createFromTransformed;this.clone=function(){return new a.rim.geometry.polygon(b.clone())};this.foreachVertex=b.foreachVertex;this.getBounds=b.getBounds;this.getIsClosed=function(){return true};this.getIsPath=function(){return true};this.getRingCount=b.getSetCount;this.getSetCount=b.getSetCount;this.getRing=b.getSet;this.getSet=b.getSet;this.pushRing=b.pushSet;this.pushSet=b.pushSet;this.popRing=b.popSet;this.popSet=b.popSet;this.toSvgPathData=b.toSvgPathData;this.addPointToLastRing=b.addPointToLastSet;this.isValid=b.isValid;this.toString=b.toString;this.getProjectedArea=function(e){var f=this.getRingCount();e=e||f-1;for(var a=this.getRing(e),d=a[1]*a[a.length-2],c=a[0]*a[a.length-1],b=0;b<a.length-2;b=b+2){d=d+a[b+0]*a[b+3];c=c+a[b+1]*a[b+2]}return Math.abs(.5*(d-c))};this.getProjectedPerimeter=function(f){var g=this.getRingCount();f=f||g-1;for(var a=this.getRing(f),d=Math.pow(a[0]-a[a.length-2],2),e=Math.pow(a[1]-a[a.length-1],2),c=Math.sqrt(d+e),b=0;b<a.length-2;b=b+2){d=Math.pow(a[b+2]-a[b+0],2);e=Math.pow(a[b+3]-a[b+1],2);c=c+Math.sqrt(d+e)}return c};this.getLabelingPoint=b.getLabelingPoint;this.getActualPerimeter=function(i){var d=this.clone(),n=d.getRingCount();i=i||n-1;for(var c=d.getRing(i),k=c.length,g=c[0],e=c[0],h=c[1],f=c[1],b=2;b<k;b++)if(b%2==0){e=Math.max(e,c[b]);g=Math.min(g,c[b])}else{f=Math.max(f,c[b]);h=Math.min(h,c[b])}var l=.5*(e+g),m=.5*(f+h);for(b=0;b<k;b+=2){var j=a.rim.sphericalMercator.getActualShapeScaleTransform(c[b+1]);c[b]=j*(c[b]-l);c[b+1]=j*(c[b+1]-m)}return d.getProjectedPerimeter()};this.getActualArea=function(i){var d=this.clone(),n=d.getRingCount();i=i||n-1;for(var c=d.getRing(i),k=c.length,g=c[0],e=c[0],h=c[1],f=c[1],b=2;b<k;b++)if(b%2==0){e=Math.max(e,c[b]);g=Math.min(g,c[b])}else{f=Math.max(f,c[b]);h=Math.min(h,c[b])}var l=.5*(e+g),m=.5*(f+h);for(b=0;b<k;b+=2){var j=a.rim.sphericalMercator.getActualShapeScaleTransform(c[b+1]);c[b]=j*(c[b]-l);c[b+1]=j*(c[b+1]-m)}return d.getProjectedArea()};this.findNearestVertex=b.findNearestVertex;this.findNearestSegment=function(a){return b.findNearestSegment(a,true)};this.intersects=function(a){var b=Math.pow(10,-4);if(a.getIsClosed())return q(a,this,b);else return j(a,this,b)};this.overlaps=function(e){var d=Math.pow(10,-4),c=new a.rim.geometry(true,true),b=new a.rim.geometry(true,true);c.pushSet(this.getSet(0));b.pushSet(e.getSet(0));return p(e,this,d)||g(b,c,d)&&g(c,b,d)}};var g=function(e,d,i){var f,c,b,h,a;if(e.length!=2){f=e.getSetCount();for(c=0;c<f;c++){b=e.getSet(c);h=b.length;for(a=0;a<h;a+=2)if(!g([b[a],b[a+1]],d,i))return false}return true}else if(d.length!=2){f=d.getSetCount();for(c=0;c<f;c++){b=d.getSet(c);h=b.length;for(a=0;a<h;a+=2)if(g(e,[b[a],b[a+1]],i))return true}return false}else if(e.length==2&&d.length==2)return Math.pow(e[0]-d[0],2)+Math.pow(e[1]-d[1],2)<i*i;return false},c=function(f,e,i){var g,d,b,h,a;if(f.length!=2){g=f.getSetCount();for(d=0;d<g;d++){b=f.getSet(d);h=b.length;for(a=0;a<h;a+=2)if(c([b[a],b[a+1]],e,i))return true}}else if(e.length!=2){g=e.getSetCount();for(d=0;d<g;d++){b=e.getSet(d);h=b.length;for(a=0;a<h;a+=2)if(c(f,[b[a],b[a+1]],i))return true}}else if(f.length==2&&e.length==2)return Math.pow(f[0]-e[0],2)+Math.pow(f[1]-e[1],2)<i*i;return false},k=function(b,a,g){var i,f,e,h,d;if(b.length!=2){i=b.getSetCount();for(f=0;f<i;f++){e=b.getSet(f);h=e.length;for(d=0;d<h;d+=2)if(k([e[d],e[d+1]],a,g))return true}}else if(a.length!=4){i=a.getSetCount();for(f=0;f<i;f++){e=a.getSet(f);h=e.length;var j;for(d=0,j=h-2;d<h;j=d,d+=2)if(k(b,[e[d],e[d+1],e[j],e[j+1]],g))return true}}else if(b.length==2&&a.length==4){if(!((a[0]<=b[0]&&b[0]<=a[2]||a[0]>=b[0]&&b[0]>=a[2])&&(a[1]<=b[1]&&b[1]<=a[3]||a[1]>=b[1]&&b[1]>=a[3])))return false;var m=b[0]-a[0],n=b[1]-a[1],l=(a[3]-a[1])/(a[2]-a[0]);return !c(b,a.slice(0,2),g)&&!c(b,a.slice(2,4),g)&&(Math.abs(l*m-n)<g||l==0&&Math.abs(b[1]-a[1])<g||Math.abs(l)==Infinity&&Math.abs(b[0]-a[0])<g)}return false},b=function(e,f,i){var j,g,d,h,a;if(e.length!=2){j=e.getSetCount();for(g=0;g<j;g++){d=e.getSet(g);h=d.length;for(a=0;a<h;a+=2)if(b([d[a],d[a+1]],f,i))return true}}else if(f.length!=4){j=f.getSetCount();for(g=0;g<j;g++){d=f.getSet(g);h=d.length;var l;for(a=0,l=h-2;a<h;l=a,a+=2)if(b(e,[d[a],d[a+1],d[l],d[l+1]],i))return true}}else if(e.length==2&&f.length==4)return c(e,f.slice(0,2),i)||c(e,f.slice(2,4),i)||k(e,f,i);return false},n=function(b,g,h){var e=g.getBounds();if(!(b[0]>=e.getMinX()&&b[0]<=e.getMaxX()&&b[1]>=e.getMinY()&&b[0]<=e.getMinY()))return false;for(var f=false,k=g.getSetCount(),i=0;i<k;i++)for(var a=g.getSet(i),j=a.length,c=0,d=j-2;c<j;d=c,c+=2)if((a[c+1]<b[1]&&a[d+1]>b[1]+h||a[d+1]<b[1]&&a[c+1]>b[1]+h)&&a[c]+(a[d]-a[c])*(b[1]-a[c+1])/(a[d+1]-a[c+1])<b[0]-h)f=!f;return f},e=function(d,g,i){var c,a;if(d.length!=2){var m=d.getSetCount();for(c=0;c<m;c++){var j=d.getSet(c),p=j.length;for(a=0;a<p;a+=2)if(e([j[a],j[a+1]],g,i))return true}}else if(d.length==2){var l=g.getSetCount();for(c=0;c<l;c++){var f=g.getSet(c),k=f.length,h;for(a=0,h=k-2;a<k;h=a,a+=2){var o=[f[a],f[a+1],f[h],f[h+1]];if(b(d,o,i))return false}}return n(d,g,i)}return false},h=function(d,f,i){var c,a;if(d.length!=2){var m=d.getSetCount();for(c=0;c<m;c++){var j=d.getSet(c),p=j.length;for(a=0;a<p;a+=2)if(h([j[a],j[a+1]],f,i))return true}}else if(d.length==2){var l=f.getSetCount();for(c=0;c<l;c++){var e=f.getSet(c),k=e.length,g;for(a=0,g=k-2;a<k;g=a,a+=2){var o=[e[a],e[a+1],e[g],e[g+1]];if(b(d,o,i))return true}}return n(d,f,i)}return false},m=function(b,a,c){if(!((b[0]<=a[0]&&b[0]>=a[2]||b[0]<=a[2]&&b[0]>=a[0]||(b[2]<=a[0]&&b[2]>=a[2]||b[2]<=a[2]&&b[2]>=a[0]))&&(b[1]<=a[1]&&b[1]>=a[3]||b[1]<=a[3]&&b[1]>=a[1]||(b[3]<=a[1]&&b[3]>=a[3]||b[3]<=a[3]&&b[3]>=a[1]))))return false;var f=b[2]*a[3]+b[0]*a[1]+a[2]*b[1]+a[0]*b[3]-a[2]*b[3]-a[0]*b[1]-b[0]*a[3]-b[2]*a[1],d=a[2]*b[1]+a[0]*a[3]+b[0]*a[1]-b[0]*a[3]-a[2]*a[1]-a[0]*b[1],e=b[2]*b[1]+b[0]*a[1]+a[0]*b[3]-b[0]*b[3]-a[0]*b[1]-b[2]*a[1];if(Math.abs(f)<c)return false;d/=f;e/=f;return Math.min(d,e)>c&&Math.max(d,e)<1-c},l=function(e,d,g){var h,f,c,i,a;if(e.length!=4){h=e.getSetCount();for(f=0;f<h;f++){c=e.getSet(f);i=c.length;for(a=0;a<i-2;a+=2)if(l([c[a],c[a+1],c[a+2],c[a+3]],d,g))return true}}else if(d.length!=4){h=d.getSetCount();for(f=0;f<h;f++){c=d.getSet(f);i=c.length;for(a=0;a<i-2;a+=2)if(l(e,[c[a],c[a+1],c[a+2],c[a+3]],g))return true}}else if(e.length==4&&d.length==4){if(b(d.slice(0,2),e,g)||b(d.slice(2,4),e,g))return false;return m(e,d,g)}return false},f=function(e,d,h){var i,g,c,j,a;if(e.length!=4){i=e.getSetCount();for(g=0;g<i;g++){c=e.getSet(g);j=c.length;for(a=0;a<j-2;a+=2)if(f([c[a],c[a+1],c[a+2],c[a+3]],d,h))return true}}else if(d.length!=4){i=d.getSetCount();for(g=0;g<i;g++){c=d.getSet(g);j=c.length;for(a=0;a<j-2;a+=2)if(f(e,[c[a],c[a+1],c[a+2],c[a+3]],h))return true}}else if(e.length==4&&d.length==4){if(b(d.slice(0,2),e,h)||b(d.slice(2,4),e,h)||b(e.slice(0,2),d,h)||b(e.slice(2,4),d,h))return true;return m(e,d,h)}return false},i=function(b,d,g){var c,a;if(b.length!=4){var n=b.getSetCount();for(c=0;c<n;c++){var h=b.getSet(c),o=h.length;for(a=0;a<o-2;a+=2)if(i([h[a],h[a+1],h[a+2],h[a+3]],d,g))return true}}else if(b.length==4){if(e(b.slice(0,2),d,g)||e(b.slice(2,4),d,g))return true;var m=d.getSetCount();for(c=0;c<m;c++){var f=d.getSet(c),k=f.length,j;for(a=0,j=k-2;a<k;j=a,a+=2)if(l([f[a],f[a+1],f[j],f[j+1]],b,g))return true}return e([(b[0]+b[2])/2,(b[1]+b[3])/2],d,g)}return false},j=function(c,e,h){var g,b,a;if(c.length!=4){g=c.getSetCount();for(b=0;b<g;b++){a=c.getSet(b);for(var l=a.length,d=0;d<l-2;d+=2)if(j([a[d],a[d+1],a[d+2],a[d+3]],e,h))return true}}else if(c.length==4){g=e.getSetCount();for(b=0;b<g;b++){a=e.getSet(b);var k=a.length;if(f(c,[a[0],a[1],a[k-2],a[k-1]],h))return true}return f(c,e,h)||i(c,e,h)}return false},p=function(h,g,j){if(e(h,g,j)||e(g,h,j))return true;for(var k=h.getSetCount(),a,c,d=0;d<k;d++){var b=h.getSet(d),f=b.length;for(a=0,c=f-2;a<f;c=a,a+=2)if(i([b[a],b[a+1],b[c],b[c+1]],g,j))return true}k=g.getSetCount();for(d=0;d<k;d++){b=g.getSet(d);f=b.length;for(a=0,c=f-2;a<f;c=a,a+=2)if(i([b[a],b[a+1],b[c],b[c+1]],h,j))return true}return false},q=function(a,e,f){if(c(a,e,f))return true;if(h(a,e,f)||h(e,a,f))return true;for(var l=a.getSetCount(),g=0;g<l;g++)for(var b=a.getSet(g),k=b.length,d=0,i=k-2;d<k;i=d,d+=2)if(j([b[d],b[d+1],b[i],b[i+1]],e,f))return true;return false}})(window)